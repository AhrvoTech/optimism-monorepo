import '../../setup'

/* External Imports */
import { ethers } from '@nomiclabs/buidler'
import { getLogger, add0x, remove0x, hexStrToBuf } from '@eth-optimism/core-utils'
import { Contract, ContractFactory, Signer } from 'ethers'

/* Internal Imports */
import {
  DEFAULT_OPCODE_WHITELIST_MASK,
  DEFAULT_UNSAFE_OPCODES,
  EVMOpcode,
  Opcode,
  makeAddressResolver,
  deployAndRegister,
  AddressResolverMapping,
} from '../../test-helpers'

/* Logging */
const log = getLogger('safety-checker', true)

/* Helpers */
const executionManagerAddress = add0x('12'.repeat(20)) // Test Execution Manager address 0x121...212
const haltingOpcodes: EVMOpcode[] = Opcode.HALTING_OP_CODES
const haltingOpcodesNoJump: EVMOpcode[] = haltingOpcodes.filter(
  (x) => x.name !== 'JUMP'
)
const jumps: EVMOpcode[] = [Opcode.JUMP, Opcode.JUMPI]
const whitelistedNotHaltingOrCALL: EVMOpcode[] = Opcode.ALL_OP_CODES.filter(
  (x) =>
    DEFAULT_UNSAFE_OPCODES.indexOf(x) < 0 &&
    haltingOpcodes.indexOf(x) < 0 &&
    x.name !== 'CALL'
)

/* Tests */
describe('Safety Checker', () => {
  let wallet: Signer
  before(async () => {
    ;[wallet] = await ethers.getSigners()
  })

  let resolver: AddressResolverMapping
  before(async () => {
    resolver = await makeAddressResolver(wallet)
  })

  let SafetyChecker: ContractFactory
  before(async () => {
    SafetyChecker = await ethers.getContractFactory('SafetyChecker')
  })

  let safetyChecker: Contract
  beforeEach(async () => {
    safetyChecker = await deployAndRegister(
      resolver.addressResolver,
      wallet,
      'SafetyChecker',
      {
        factory: SafetyChecker,
        params: [
          resolver.addressResolver.address,
          DEFAULT_OPCODE_WHITELIST_MASK,
        ],
      }
    )

    await resolver.addressResolver.setAddress(
      'ExecutionManager',
      executionManagerAddress
    )
  })

  const getTxCalldataGasCostForConsumeGas = (calldata: string): number => {
    const calldataBuf = hexStrToBuf(calldata)

    const nonzeroByteCost = 16
    const zeroBytecost = 4

    let txCalldataGas = 0
    for (const [index, byte] of calldataBuf.entries()) {
      if (byte === 0) {
        txCalldataGas += zeroBytecost
      } else {
        txCalldataGas += nonzeroByteCost
      }
    }
    return txCalldataGas
  }

  describe('isBytecodeSafe()', async () => {
          // const synthetixInitcodeRaw = '6101406040526b53797374656d53746174757360a01b60809081526822bc31b430b733b2b960b91b60a0526524b9b9bab2b960d11b60c0526d537570706c795363686564756c6560901b60e0527f52657761726473446973747269627574696f6e00000000000000000000000000610100526d53796e746865746978537461746560901b610120526200009790600e9060066200065d565b50348015620000a557600080fd5b506040516200882938038062008829833981810160405260a0811015620000cb57600080fd5b5080516020820151604080840151606085015160809095015182516103008101938490529495939491939290918291600e9060189082845b816200010e620006ab565b815260200190600101908083116200010357505050505086866040518060400160405280601781526020017f53796e746865746978204e6574776f726b20546f6b656e000000000000000000815250604051806040016040528060038152602001620a69cb60eb1b8152508760128a868160006001600160a01b0316816001600160a01b03161415620001e8576040805162461bcd60e51b815260206004820152601960248201527f4f776e657220616464726573732063616e6e6f74206265203000000000000000604482015290519081900360640190fd5b806000600181620001f8620006ab565b816001600160a01b0302191690836001600160a01b03160217906200021c620006e4565b505060408051600081526001600160a01b038416602082015281517fb532073b38c83145e3e5135377a08bf9aab55bc0fd7c1179cd4fb995d2a5159c93509081900390910190a1506000808062000272620006ab565b906101000a90046001600160a01b03166001600160a01b03161415620002d3576040805162461bcd60e51b815260206004820152601160248201527013dddb995c881b5d5cdd081899481cd95d607a1b604482015290519081900360640190fd5b600080620002e0620006ab565b906101000a90046001600160a01b0316600360016101000a8162000303620006ab565b816001600160a01b0302191690836001600160a01b031602179062000327620006e4565b5050507fd5da63a0b864b315bc04128dedbc93888c8529ee6cf47ce664dc204339228c536000809062000359620006ab565b604080516101009390930a9091046001600160a01b03168252516020918190039190910190a1600080806200038d620006ab565b906101000a90046001600160a01b03166001600160a01b03161415620003ee576040805162461bcd60e51b815260206004820152601160248201527013dddb995c881b5d5cdd081899481cd95d607a1b604482015290519081900360640190fd5b806004600181620003fe620006ab565b816001600160a01b0302191690836001600160a01b031602179062000422620006e4565b5050604080516001600160a01b038416815290517ffc80377ca9c49cc11ae6982f390a42db976d5530af7c43889264b13fbbd7c57e92509081900360200190a15085600760018162000473620006ab565b816001600160a01b0302191690836001600160a01b031602179062000497620006e4565b50508551620004af9150600890602088019062000721565b508351620004c590600990602087019062000721565b508280600a620004d4620006e4565b50505081600b60006101000a81620004eb620006ab565b8160ff021916908360ff1602179062000503620006e4565b5050505050505050505060006001600160a01b03166000809062000526620006ab565b906101000a90046001600160a01b03166001600160a01b0316141562000587576040805162461bcd60e51b815260206004820152601160248201527013dddb995c881b5d5cdd081899481cd95d607a1b604482015290519081900360640190fd5b60005b601881101562000617576000828260188110620005a357fe5b6020020151146200060857600d828260188110620005bd57fe5b60200201519080600181620005d1620006ab565b018082620005de620006e4565b5050600092835260209092209192918301600019019050620005ff620006e4565b5050506200060e565b62000617565b6001016200058a565b5081600b6101008162000629620006ab565b816001600160a01b0302191690836001600160a01b03160217906200064d620006e4565b5050505050505050505062000823565b826018810192821562000699579160200282015b82811115620006995782518262000687620006e4565b50509160200191906001019062000671565b50620006a7929150620007cc565b5090565b630412cc4160e31b62080000908152620800048390526320966208906020816024816000335af180620006dd57600080fd5b5051925050565b630146e59560e51b6208000090815262080004839052620800248490526328dcb2a09060008160448183335af1806200071c57600080fd5b505050565b82806200072d620006ab565b600181600116156101000203166002900490600052602060002090601f016020900481019282601f106200077857805160ff1916838001178562000770620006e4565b5050620007be565b8280016001018562000789620006e4565b50508215620007be579182015b82811115620007be57825182620007ac620006e4565b50509160200191906001019062000796565b50620006a7929150620007f9565b620007f691905b80821115620006a75760008082620007ea620006e4565b505050600101620007d3565b90565b620007f691905b80821115620006a7576000808262000817620006e4565b50505060010162000800565b617ff680620008336000396000f3fe608060405234801561001057600080fd5b50600436106104725760003560e01c80638da5cb5b11610250578063bc67f83211610150578063dbf63340116100c8578063e8e09b8b11610097578063ec5568891161007c578063ec55688914610e34578063ee52a2f314610e3c578063f354cad114610e6557610472565b8063e8e09b8b14610df3578063e90dd9e214610e2c57610472565b8063dbf6334014610d6f578063dd62ed3e14610d77578063e3235c9114610db2578063e6203ed114610dba57610472565b8063c6c9d8281161011f578063d37c4d8b11610104578063d37c4d8b14610d11578063d60888e414610d4a578063d67bdd2514610d6757610472565b8063c6c9d82814610caf578063c836fa0a14610ccc57610472565b8063bc67f83214610c33578063bd32aa4414610c66578063c2bf388014610c6e578063c58aaae614610ca757610472565b80639f769807116101e3578063a9059cbb116101b2578063ace88afd11610197578063ace88afd14610be4578063af086c7e14610c23578063b8225dec14610c2b57610472565b8063a9059cbb14610b6a578063ab49848c14610ba357610472565b80639f76980714610ac9578063a311c7c214610afc578063a461fc8214610b2f578063a5fdc5de14610b3757610472565b80639741fb221161021f5780639741fb2214610a94578063987757dd14610a9c5780639cb8a26a14610ab95780639cbdaeb614610ac157610472565b80638da5cb5b14610a495780639324cac714610a5157806395d89b4114610a5957806397107d6d14610a6157610472565b80632c955fa7116103765780636ac0bf9c116102ee57806372cb051f116102bd578063835e119c116102a2578063835e119c146109f257806383d625d414610a0f5780638a29001414610a2c57610472565b806372cb051f1461099257806379ba5097146109ea57610472565b80636ac0bf9c1461089a5780636c00f310146108cd5780636f01a9861461092057806370a082311461095f57610472565b806332608039116103455780633be99e6f1161032a5780633be99e6f1461082c57806353a47bb71461085f578063631e14441461086757610472565b806332608039146108075780633278c9601461082457610472565b80632c955fa71461077b5780632e0f2625146107ae578063313ce567146107cc578063320223db146107d457610472565b806316b2213f116104095780631fce304d116103d857806323b872dd116103bd57806323b872dd14610713578063295da87d146107565780632a9053181461077357610472565b80631fce304d146106c357806320714f88146106e057610472565b806316b2213f1461067857806317c70de4146106ab57806318160ddd146106b357806318821400146106bb57610472565b80631137aedf116104455780631137aedf146105b75780631249c58b14610608578063131b0ae7146106105780631627540c1461064557610472565b806304f3bcec1461047757806305b3c1c9146104a857806306fdde03146104ed578063095ea7b31461056a575b600080fd5b61047f610e6d565b6040805173ffffffffffffffffffffffffffffffffffffffff9092168252519081900360200190f35b6104db600480360360208110156104be57600080fd5b503573ffffffffffffffffffffffffffffffffffffffff16610e99565b60408051918252519081900360200190f35b6104f5610f66565b6040805160208082528351818301528351919283929083019185019080838360005b8381101561052f578181015183820152602001610517565b50505050905090810190601f16801561055c5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6105a36004803603604081101561058057600080fd5b5073ffffffffffffffffffffffffffffffffffffffff8135169060200135611020565b604080519115158252519081900360200190f35b6105ea600480360360208110156105cd57600080fd5b503573ffffffffffffffffffffffffffffffffffffffff166112ae565b60408051938452602084019290925282820152519081900360600190f35b6105a361138e565b6106436004803603602081101561062657600080fd5b503573ffffffffffffffffffffffffffffffffffffffff16611b8b565b005b6106436004803603602081101561065b57600080fd5b503573ffffffffffffffffffffffffffffffffffffffff16611c8e565b6104db6004803603602081101561068e57600080fd5b503573ffffffffffffffffffffffffffffffffffffffff16611dda565b6104db611e5b565b6104db611e68565b6104f5611e72565b6105a3600480360360208110156106d957600080fd5b5035611eab565b610643600480360360208110156106f657600080fd5b503573ffffffffffffffffffffffffffffffffffffffff16611fa8565b6105a36004803603606081101561072957600080fd5b5073ffffffffffffffffffffffffffffffffffffffff813581169160208101359091169060400135612178565b6106436004803603602081101561076c57600080fd5b50356123c3565b6104f56126ad565b6106436004803603602081101561079157600080fd5b503573ffffffffffffffffffffffffffffffffffffffff166126e6565b6107b66129c7565b6040805160ff9092168252519081900360200190f35b6107b66129cc565b610643600480360360208110156107ea57600080fd5b503573ffffffffffffffffffffffffffffffffffffffff166129e5565b61047f6004803603602081101561081d57600080fd5b5035612c19565b610643612c6e565b6106436004803603602081101561084257600080fd5b503573ffffffffffffffffffffffffffffffffffffffff16612d87565b61047f613024565b6105a36004803603602081101561087d57600080fd5b503573ffffffffffffffffffffffffffffffffffffffff16613030565b6104db600480360360208110156108b057600080fd5b503573ffffffffffffffffffffffffffffffffffffffff16613252565b610643600480360360c08110156108e357600080fd5b5073ffffffffffffffffffffffffffffffffffffffff813581169160208101359160408201359160608101359160808201359160a001351661340f565b6106436004803603606081101561093657600080fd5b5073ffffffffffffffffffffffffffffffffffffffff8135169060208101359060400135613684565b6104db6004803603602081101561097557600080fd5b503573ffffffffffffffffffffffffffffffffffffffff166138b2565b61099a613953565b60408051602080825283518183015283519192839290830191858101910280838360005b838110156109d65781810151838201526020016109be565b505050509050019250505060405180910390f35b610643613aa1565b61047f60048036036020811015610a0857600080fd5b5035613cb2565b6104db60048036036020811015610a2557600080fd5b5035613d07565b61064360048036036020811015610a4257600080fd5b5035613d69565b61047f613f9c565b6104db613fa7565b6104f5613fcb565b61064360048036036020811015610a7757600080fd5b503573ffffffffffffffffffffffffffffffffffffffff1661406e565b6106436141bb565b6105ea60048036036020811015610ab257600080fd5b5035614495565b610643614701565b61047f61495a565b61064360048036036020811015610adf57600080fd5b503573ffffffffffffffffffffffffffffffffffffffff16614966565b6104db60048036036020811015610b1257600080fd5b503573ffffffffffffffffffffffffffffffffffffffff16614c1c565b6104db614c9d565b6104db60048036036020811015610b4d57600080fd5b503573ffffffffffffffffffffffffffffffffffffffff16614ca4565b6105a360048036036040811015610b8057600080fd5b5073ffffffffffffffffffffffffffffffffffffffff8135169060200135614d25565b610bab614f90565b604051808261030080838360005b83811015610bd1578181015183820152602001610bb9565b5050505090500191505060405180910390f35b61064360048036036060811015610bfa57600080fd5b5073ffffffffffffffffffffffffffffffffffffffff8135169060208101359060400135614ff2565b61064361512b565b6105a361535e565b61064360048036036020811015610c4957600080fd5b503573ffffffffffffffffffffffffffffffffffffffff1661536a565b6106436154a8565b61064360048036036040811015610c8457600080fd5b5073ffffffffffffffffffffffffffffffffffffffff81351690602001356155d6565b61047f6158f4565b6104db60048036036020811015610cc557600080fd5b5035615900565b6104db60048036036080811015610ce257600080fd5b5073ffffffffffffffffffffffffffffffffffffffff8135169060208101359060408101359060600135615929565b6104db60048036036040811015610d2757600080fd5b5073ffffffffffffffffffffffffffffffffffffffff8135169060200135615d01565b6104db60048036036020811015610d6057600080fd5b5035615dd5565b61047f615e37565b6104db615e43565b6104db60048036036040811015610d8d57600080fd5b5073ffffffffffffffffffffffffffffffffffffffff81358116916020013516615ed6565b6104db615f5e565b6105a360048036036040811015610dd057600080fd5b5073ffffffffffffffffffffffffffffffffffffffff8135169060200135615f63565b61064360048036036040811015610e0957600080fd5b5073ffffffffffffffffffffffffffffffffffffffff8135169060200135616311565b61047f616545565b61047f616551565b6104db60048036036060811015610e5257600080fd5b508035906020810135906040013561655d565b6105a361695d565b6001600b610e79617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b6000610ea36169a7565b73ffffffffffffffffffffffffffffffffffffffff166305b3c1c9836040518263ffffffff1660e01b8152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019150506020604051808303818680610f1a617c0c565b158015610f2657600080fd5b505a610f30617c56565b5050505050158015610f46573d6000803e3d6000fd5b505050506040513d6020811015610f5c57600080fd5b505190505b919050565b600880610f71617bbb565b600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280610fac617bbb565b600181600116156101000203166002900480156110185780601f10610fe6576101008083610fd8617bbb565b040283529160200191611018565b820191906000526020600020905b81610ffd617bbb565b81529060010190602001808311610ff457829003601f168201915b505050505081565b600080600461102d617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a611069617cc6565b73ffffffffffffffffffffffffffffffffffffffff16141580156110e9575060006005611094617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a6110d0'
      const synthetixInitcodeRaw = '6101406040526b53797374656d53746174757360a01b60809081526822bc31b430b733b2b960b91b60a0526524b9b9bab2b960d11b60c0526d537570706c795363686564756c6560901b60e0527f52657761726473446973747269627574696f6e00000000000000000000000000610100526d53796e746865746978537461746560901b610120526200009790600e9060066200065d565b50348015620000a557600080fd5b506040516200882938038062008829833981810160405260a0811015620000cb57600080fd5b5080516020820151604080840151606085015160809095015182516103008101938490529495939491939290918291600e9060189082845b816200010e620006ab565b815260200190600101908083116200010357505050505086866040518060400160405280601781526020017f53796e746865746978204e6574776f726b20546f6b656e000000000000000000815250604051806040016040528060038152602001620a69cb60eb1b8152508760128a868160006001600160a01b0316816001600160a01b03161415620001e8576040805162461bcd60e51b815260206004820152601960248201527f4f776e657220616464726573732063616e6e6f74206265203000000000000000604482015290519081900360640190fd5b806000600181620001f8620006ab565b816001600160a01b0302191690836001600160a01b03160217906200021c620006e4565b505060408051600081526001600160a01b038416602082015281517fb532073b38c83145e3e5135377a08bf9aab55bc0fd7c1179cd4fb995d2a5159c93509081900390910190a1506000808062000272620006ab565b906101000a90046001600160a01b03166001600160a01b03161415620002d3576040805162461bcd60e51b815260206004820152601160248201527013dddb995c881b5d5cdd081899481cd95d607a1b604482015290519081900360640190fd5b600080620002e0620006ab565b906101000a90046001600160a01b0316600360016101000a8162000303620006ab565b816001600160a01b0302191690836001600160a01b031602179062000327620006e4565b5050507fd5da63a0b864b315bc04128dedbc93888c8529ee6cf47ce664dc204339228c536000809062000359620006ab565b604080516101009390930a9091046001600160a01b03168252516020918190039190910190a1600080806200038d620006ab565b906101000a90046001600160a01b03166001600160a01b03161415620003ee576040805162461bcd60e51b815260206004820152601160248201527013dddb995c881b5d5cdd081899481cd95d607a1b604482015290519081900360640190fd5b806004600181620003fe620006ab565b816001600160a01b0302191690836001600160a01b031602179062000422620006e4565b5050604080516001600160a01b038416815290517ffc80377ca9c49cc11ae6982f390a42db976d5530af7c43889264b13fbbd7c57e92509081900360200190a15085600760018162000473620006ab565b816001600160a01b0302191690836001600160a01b031602179062000497620006e4565b50508551620004af9150600890602088019062000721565b508351620004c590600990602087019062000721565b508280600a620004d4620006e4565b50505081600b60006101000a81620004eb620006ab565b8160ff021916908360ff1602179062000503620006e4565b5050505050505050505060006001600160a01b03166000809062000526620006ab565b906101000a90046001600160a01b03166001600160a01b0316141562000587576040805162461bcd60e51b815260206004820152601160248201527013dddb995c881b5d5cdd081899481cd95d607a1b604482015290519081900360640190fd5b60005b601881101562000617576000828260188110620005a357fe5b6020020151146200060857600d828260188110620005bd57fe5b60200201519080600181620005d1620006ab565b018082620005de620006e4565b5050600092835260209092209192918301600019019050620005ff620006e4565b5050506200060e565b62000617565b6001016200058a565b5081600b6101008162000629620006ab565b816001600160a01b0302191690836001600160a01b03160217906200064d620006e4565b5050505050505050505062000823565b826018810192821562000699579160200282015b82811115620006995782518262000687620006e4565b50509160200191906001019062000671565b50620006a7929150620007cc565b5090565b630412cc4160e31b62080000908152620800048390526320966208906020816024816000335af180620006dd57600080fd5b5051925050565b630146e59560e51b6208000090815262080004839052620800248490526328dcb2a09060008160448183335af1806200071c57600080fd5b505050565b82806200072d620006ab565b600181600116156101000203166002900490600052602060002090601f016020900481019282601f106200077857805160ff1916838001178562000770620006e4565b5050620007be565b8280016001018562000789620006e4565b50508215620007be579182015b82811115620007be57825182620007ac620006e4565b50509160200191906001019062000796565b50620006a7929150620007f9565b620007f691905b80821115620006a75760008082620007ea620006e4565b505050600101620007d3565b90565b620007f691905b80821115620006a7576000808262000817620006e4565b50505060010162000800565b617ff680620008336000396000f3fe608060405234801561001057600080fd5b50600436106104725760003560e01c80638da5cb5b11610250578063bc67f83211610150578063dbf63340116100c8578063e8e09b8b11610097578063ec5568891161007c578063ec55688914610e34578063ee52a2f314610e3c578063f354cad114610e6557610472565b8063e8e09b8b14610df3578063e90dd9e214610e2c57610472565b8063dbf6334014610d6f578063dd62ed3e14610d77578063e3235c9114610db2578063e6203ed114610dba57610472565b8063c6c9d8281161011f578063d37c4d8b11610104578063d37c4d8b14610d11578063d60888e414610d4a578063d67bdd2514610d6757610472565b8063c6c9d82814610caf578063c836fa0a14610ccc57610472565b8063bc67f83214610c33578063bd32aa4414610c66578063c2bf388014610c6e578063c58aaae614610ca757610472565b80639f769807116101e3578063a9059cbb116101b2578063ace88afd11610197578063ace88afd14610be4578063af086c7e14610c23578063b8225dec14610c2b57610472565b8063a9059cbb14610b6a578063ab49848c14610ba357610472565b80639f76980714610ac9578063a311c7c214610afc578063a461fc8214610b2f578063a5fdc5de14610b3757610472565b80639741fb221161021f5780639741fb2214610a94578063987757dd14610a9c5780639cb8a26a14610ab95780639cbdaeb614610ac157610472565b80638da5cb5b14610a495780639324cac714610a5157806395d89b4114610a5957806397107d6d14610a6157610472565b80632c955fa7116103765780636ac0bf9c116102ee57806372cb051f116102bd578063835e119c116102a2578063835e119c146109f257806383d625d414610a0f5780638a29001414610a2c57610472565b806372cb051f1461099257806379ba5097146109ea57610472565b80636ac0bf9c1461089a5780636c00f310146108cd5780636f01a9861461092057806370a082311461095f57610472565b806332608039116103455780633be99e6f1161032a5780633be99e6f1461082c57806353a47bb71461085f578063631e14441461086757610472565b806332608039146108075780633278c9601461082457610472565b80632c955fa71461077b5780632e0f2625146107ae578063313ce567146107cc578063320223db146107d457610472565b806316b2213f116104095780631fce304d116103d857806323b872dd116103bd57806323b872dd14610713578063295da87d146107565780632a9053181461077357610472565b80631fce304d146106c357806320714f88146106e057610472565b806316b2213f1461067857806317c70de4146106ab57806318160ddd146106b357806318821400146106bb57610472565b80631137aedf116104455780631137aedf146105b75780631249c58b14610608578063131b0ae7146106105780631627540c1461064557610472565b806304f3bcec1461047757806305b3c1c9146104a857806306fdde03146104ed578063095ea7b31461056a575b600080fd5b61047f610e6d565b6040805173ffffffffffffffffffffffffffffffffffffffff9092168252519081900360200190f35b6104db600480360360208110156104be57600080fd5b503573ffffffffffffffffffffffffffffffffffffffff16610e99565b60408051918252519081900360200190f35b6104f5610f66565b6040805160208082528351818301528351919283929083019185019080838360005b8381101561052f578181015183820152602001610517565b50505050905090810190601f16801561055c5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6105a36004803603604081101561058057600080fd5b5073ffffffffffffffffffffffffffffffffffffffff8135169060200135611020565b604080519115158252519081900360200190f35b6105ea600480360360208110156105cd57600080fd5b503573ffffffffffffffffffffffffffffffffffffffff166112ae565b60408051938452602084019290925282820152519081900360600190f35b6105a361138e565b6106436004803603602081101561062657600080fd5b503573ffffffffffffffffffffffffffffffffffffffff16611b8b565b005b6106436004803603602081101561065b57600080fd5b503573ffffffffffffffffffffffffffffffffffffffff16611c8e565b6104db6004803603602081101561068e57600080fd5b503573ffffffffffffffffffffffffffffffffffffffff16611dda565b6104db611e5b565b6104db611e68565b6104f5611e72565b6105a3600480360360208110156106d957600080fd5b5035611eab565b610643600480360360208110156106f657600080fd5b503573ffffffffffffffffffffffffffffffffffffffff16611fa8565b6105a36004803603606081101561072957600080fd5b5073ffffffffffffffffffffffffffffffffffffffff813581169160208101359091169060400135612178565b6106436004803603602081101561076c57600080fd5b50356123c3565b6104f56126ad565b6106436004803603602081101561079157600080fd5b503573ffffffffffffffffffffffffffffffffffffffff166126e6565b6107b66129c7565b6040805160ff9092168252519081900360200190f35b6107b66129cc565b610643600480360360208110156107ea57600080fd5b503573ffffffffffffffffffffffffffffffffffffffff166129e5565b61047f6004803603602081101561081d57600080fd5b5035612c19565b610643612c6e565b6106436004803603602081101561084257600080fd5b503573ffffffffffffffffffffffffffffffffffffffff16612d87565b61047f613024565b6105a36004803603602081101561087d57600080fd5b503573ffffffffffffffffffffffffffffffffffffffff16613030565b6104db600480360360208110156108b057600080fd5b503573ffffffffffffffffffffffffffffffffffffffff16613252565b610643600480360360c08110156108e357600080fd5b5073ffffffffffffffffffffffffffffffffffffffff813581169160208101359160408201359160608101359160808201359160a001351661340f565b6106436004803603606081101561093657600080fd5b5073ffffffffffffffffffffffffffffffffffffffff8135169060208101359060400135613684565b6104db6004803603602081101561097557600080fd5b503573ffffffffffffffffffffffffffffffffffffffff166138b2565b61099a613953565b60408051602080825283518183015283519192839290830191858101910280838360005b838110156109d65781810151838201526020016109be565b505050509050019250505060405180910390f35b610643613aa1565b61047f60048036036020811015610a0857600080fd5b5035613cb2565b6104db60048036036020811015610a2557600080fd5b5035613d07565b61064360048036036020811015610a4257600080fd5b5035613d69565b61047f613f9c565b6104db613fa7565b6104f5613fcb565b61064360048036036020811015610a7757600080fd5b503573ffffffffffffffffffffffffffffffffffffffff1661406e565b6106436141bb565b6105ea60048036036020811015610ab257600080fd5b5035614495565b610643614701565b61047f61495a565b61064360048036036020811015610adf57600080fd5b503573ffffffffffffffffffffffffffffffffffffffff16614966565b6104db60048036036020811015610b1257600080fd5b503573ffffffffffffffffffffffffffffffffffffffff16614c1c565b6104db614c9d565b6104db60048036036020811015610b4d57600080fd5b503573ffffffffffffffffffffffffffffffffffffffff16614ca4565b6105a360048036036040811015610b8057600080fd5b5073ffffffffffffffffffffffffffffffffffffffff8135169060200135614d25565b610bab614f90565b604051808261030080838360005b83811015610bd1578181015183820152602001610bb9565b5050505090500191505060405180910390f35b61064360048036036060811015610bfa57600080fd5b5073ffffffffffffffffffffffffffffffffffffffff8135169060208101359060400135614ff2565b61064361512b565b6105a361535e565b61064360048036036020811015610c4957600080fd5b503573ffffffffffffffffffffffffffffffffffffffff1661536a565b6106436154a8565b61064360048036036040811015610c8457600080fd5b5073ffffffffffffffffffffffffffffffffffffffff81351690602001356155d6565b61047f6158f4565b6104db60048036036020811015610cc557600080fd5b5035615900565b6104db60048036036080811015610ce257600080fd5b5073ffffffffffffffffffffffffffffffffffffffff8135169060208101359060408101359060600135615929565b6104db60048036036040811015610d2757600080fd5b5073ffffffffffffffffffffffffffffffffffffffff8135169060200135615d01565b6104db60048036036020811015610d6057600080fd5b5035615dd5565b61047f615e37565b6104db615e43565b6104db60048036036040811015610d8d57600080fd5b5073ffffffffffffffffffffffffffffffffffffffff81358116916020013516615ed6565b6104db615f5e565b6105a360048036036040811015610dd057600080fd5b5073ffffffffffffffffffffffffffffffffffffffff8135169060200135615f63565b61064360048036036040811015610e0957600080fd5b5073ffffffffffffffffffffffffffffffffffffffff8135169060200135616311565b61047f616545565b61047f616551565b6104db60048036036060811015610e5257600080fd5b508035906020810135906040013561655d565b6105a361695d565b6001600b610e79617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b6000610ea36169a7565b73ffffffffffffffffffffffffffffffffffffffff166305b3c1c9836040518263ffffffff1660e01b8152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019150506020604051808303818680610f1a617c0c565b158015610f2657600080fd5b505a610f30617c56565b5050505050158015610f46573d6000803e3d6000fd5b505050506040513d6020811015610f5c57600080fd5b505190505b919050565b600880610f71617bbb565b600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280610fac617bbb565b600181600116156101000203166002900480156110185780601f10610fe6576101008083610fd8617bbb565b040283529160200191611018565b820191906000526020600020905b81610ffd617bbb565b81529060010190602001808311610ff457829003601f168201915b505050505081565b600080600461102d617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a611069617cc6565b73ffffffffffffffffffffffffffffffffffffffff16141580156110e9575060006005611094617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a6110d0617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614155b801561115157505a6110f9617cc6565b73ffffffffffffffffffffffffffffffffffffffff166000600661111b617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614155b156111ac575a61115f617cc6565b600660018161116c617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217906111a8617cea565b5050505b60008060066111b9617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff16905060076000906111e5617bbb565b604080517fda46098c00000000000000000000000000000000000000000000000000000000815273ffffffffffffffffffffffffffffffffffffffff858116600483015288811660248301526044820188905291516101009490940a909204169163da46098c916064808201926000929091908290030181838780611268617c0c565b15801561127457600080fd5b505a61127e617d3a565b505050505050158015611295573d6000803e3d6000fd5b505050506112a4818585616a0d565b5060019392505050565b60008060006112bb6169a7565b73ffffffffffffffffffffffffffffffffffffffff16631137aedf856040518263ffffffff1660e01b8152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019150506060604051808303818680611332617c0c565b15801561133e57600080fd5b505a611348617c56565b505050505015801561135e573d6000803e3d6000fd5b505050506040513d606081101561137457600080fd5b508051602082015160409092015190969195509350915050565b6000611398616b0c565b73ffffffffffffffffffffffffffffffffffffffff16637c3125416040518163ffffffff1660e01b815260040160006040518083038186806113d8617c0c565b1580156113e457600080fd5b505a6113ee617c56565b5050505050158015611404573d6000803e3d6000fd5b50505050600073ffffffffffffffffffffffffffffffffffffffff16611428616b6d565b73ffffffffffffffffffffffffffffffffffffffff1614156114ab57604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601b60248201527f52657761726473446973747269627574696f6e206e6f74207365740000000000604482015290519081900360640190fd5b60006114b5616bb1565b905060006114c1616b6d565b905060008273ffffffffffffffffffffffffffffffffffffffff1663cc5c095c6040518163ffffffff1660e01b81526004016020604051808303818680611506617c0c565b15801561151257600080fd5b505a61151c617c56565b5050505050158015611532573d6000803e3d6000fd5b505050506040513d602081101561154857600080fd5b50519050806115b857604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601560248201527f4e6f20737570706c79206973206d696e7461626c650000000000000000000000604482015290519081900360640190fd5b8273ffffffffffffffffffffffffffffffffffffffff16637e7961d7826040518263ffffffff1660e01b81526004018082815260200191505060206040518083038160008780611606617c0c565b15801561161257600080fd5b505a61161c617d3a565b505050505050158015611633573d6000803e3d6000fd5b505050506040513d602081101561164957600080fd5b5050604080517f9bdd7ac7000000000000000000000000000000000000000000000000000000008152905160009173ffffffffffffffffffffffffffffffffffffffff861691639bdd7ac791600480820192602092909190829003018186806116b0617c0c565b1580156116bc57600080fd5b505a6116c6617c56565b50505050501580156116dc573d6000803e3d6000fd5b505050506040513d60208110156116f257600080fd5b505190506000611708838363ffffffff616c1216565b905060006007611716617bbb565b73ffffffffffffffffffffffffffffffffffffffff6101009290920a90041663b46310f68561182f846000600761174b617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166370a082318a6040518263ffffffff1660e01b8152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060206040518083038186806117df617c0c565b1580156117eb57600080fd5b505a6117f5617c56565b505050505015801561180b573d6000803e3d6000fd5b505050506040513d602081101561182157600080fd5b50519063ffffffff616c8916565b6040518363ffffffff1660e01b8152600401808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018281526020019250505060006040518083038160008780611893617c0c565b15801561189f57600080fd5b505a6118a9617d3a565b5050505050501580156118c0573d6000803e3d6000fd5b505050506118f95a63996d79a5620800008160e01b81526020816004836000335af1806118ec57600080fd5b5051915086905083616d04565b8373ffffffffffffffffffffffffffffffffffffffff166359974e38826040518263ffffffff1660e01b81526004018082815260200191505060206040518083038160008780611947617c0c565b15801561195357600080fd5b505a61195d617d3a565b505050505050158015611974573d6000803e3d6000fd5b505050506040513d602081101561198a57600080fd5b50600090506007611999617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663b46310f65a6119da617cc6565b611a8685600060076119ea617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166370a082315a611a2b617cc6565b6040518263ffffffff1660e01b8152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060206040518083038186806117df617c0c565b6040518363ffffffff1660e01b8152600401808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018281526020019250505060006040518083038160008780611aea617c0c565b158015611af657600080fd5b505a611b00617d3a565b505050505050158015611b17573d6000803e3d6000fd5b50505050611b575a63996d79a5620800008160e01b81526020816004836000335af180611b4357600080fd5b50519150505a611b51617cc6565b84616d04565b611b7183600a611b65617bbb565b9063ffffffff616c8916565b80600a611b7c617cea565b50505060019550505050505090565b600080611b96617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a611bd2617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614611c3e576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602f815260200180617eaf602f913960400191505060405180910390fd5b806005600181611c4c617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790611c88617cea565b50505050565b600080611c99617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a611cd5617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614611d41576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602f815260200180617eaf602f913960400191505060405180910390fd5b8060018080611d4e617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790611d8a617cea565b50506040805173ffffffffffffffffffffffffffffffffffffffff8416815290517f906a1c6bd7e3091ea86693dd029a831c19049ce77f1dce2ce0bab1cacbabce2292509081900360200190a150565b6000611de46169a7565b73ffffffffffffffffffffffffffffffffffffffff166316b2213f836040518263ffffffff1660e01b8152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019150506020604051808303818680610f1a617c0c565b6002611e65617bbb565b81565b600a611e65617bbb565b6040518060400160405280601781526020017f53796e746865746978204e6574776f726b20546f6b656e00000000000000000081525081565b600080611eb6616d8c565b73ffffffffffffffffffffffffffffffffffffffff1663059c29ec60006006611edd617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff16856040518363ffffffff1660e01b8152600401808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001828152602001925050506020604051808303818680611f5d617c0c565b158015611f6957600080fd5b505a611f73617c56565b5050505050158015611f89573d6000803e3d6000fd5b505050506040513d6020811015611f9f57600080fd5b50511192915050565b600080611fb3617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a611fef617cc6565b73ffffffffffffffffffffffffffffffffffffffff161461205b576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602f815260200180617eaf602f913960400191505060405180910390fd5b73ffffffffffffffffffffffffffffffffffffffff81166120dd57604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601c60248201527f42656e6566696369617279206d757374206e6f74206265207a65726f00000000604482015290519081900360640190fd5b806003610100816120ec617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790612128617cea565b50506040805173ffffffffffffffffffffffffffffffffffffffff8416815290517fd5da63a0b864b315bc04128dedbc93888c8529ee6cf47ce664dc204339228c5392509081900360200190a150565b6000806004612185617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a6121c1617cc6565b73ffffffffffffffffffffffffffffffffffffffff16141580156122415750600060056121ec617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a612228617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614155b80156122a957505a612251617cc6565b73ffffffffffffffffffffffffffffffffffffffff1660006006612273617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614155b15612304575a6122b7617cc6565b60066001816122c4617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790612300617cea565b5050505b61230c616b0c565b73ffffffffffffffffffffffffffffffffffffffff1663086dabd16040518163ffffffff1660e01b8152600401600060405180830381868061234c617c0c565b15801561235857600080fd5b505a612362617c56565b5050505050158015612378573d6000803e3d6000fd5b505050506123868483616ded565b506123bb60006006612396617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff16858585617141565b949350505050565b6123cb616b0c565b73ffffffffffffffffffffffffffffffffffffffff16637c3125416040518163ffffffff1660e01b8152600401600060405180830381868061240b617c0c565b15801561241757600080fd5b505a612421617c56565b5050505050158015612437573d6000803e3d6000fd5b505050506004600090612448617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a612484617cc6565b73ffffffffffffffffffffffffffffffffffffffff16141580156125045750600060056124af617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a6124eb617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614155b801561256c57505a612514617cc6565b73ffffffffffffffffffffffffffffffffffffffff1660006006612536617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614155b156125c7575a61257a617cc6565b6006600181612587617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217906125c3617cea565b5050505b6125cf6169a7565b73ffffffffffffffffffffffffffffffffffffffff1663b06e8c65600060066125f6617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff16836040518363ffffffff1660e01b8152600401808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018281526020019250505060006040518083038160008780612678617c0c565b15801561268457600080fd5b505a61268e617d3a565b5050505050501580156126a5573d6000803e3d6000fd5b505050505b50565b6040518060400160405280600381526020017f534e58000000000000000000000000000000000000000000000000000000000081525081565b6126ee616b0c565b73ffffffffffffffffffffffffffffffffffffffff16637c3125416040518163ffffffff1660e01b8152600401600060405180830381868061272e617c0c565b15801561273a57600080fd5b505a612744617c56565b505050505015801561275a573d6000803e3d6000fd5b50505050600460009061276b617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a6127a7617cc6565b73ffffffffffffffffffffffffffffffffffffffff16141580156128275750600060056127d2617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a61280e617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614155b801561288f57505a612837617cc6565b73ffffffffffffffffffffffffffffffffffffffff1660006006612859617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614155b156128ea575a61289d617cc6565b60066001816128aa617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217906128e6617cea565b5050505b6128f26169a7565b73ffffffffffffffffffffffffffffffffffffffff16632b3f41aa826000600661291a617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff166040518363ffffffff1660e01b8152600401808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019250505060006040518083038160008780612678617c0c565b601281565b6000600b6129d8617bbb565b906101000a900460ff1681565b6129ed616b0c565b73ffffffffffffffffffffffffffffffffffffffff16637c3125416040518163ffffffff1660e01b81526004016000604051808303818680612a2d617c0c565b158015612a3957600080fd5b505a612a43617c56565b5050505050158015612a59573d6000803e3d6000fd5b505050506004600090612a6a617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a612aa6617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614158015612b26575060006005612ad1617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a612b0d617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614155b8015612b8e57505a612b36617cc6565b73ffffffffffffffffffffffffffffffffffffffff1660006006612b58617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614155b15612be9575a612b9c617cc6565b6006600181612ba9617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790612be5617cea565b5050505b612bf16169a7565b73ffffffffffffffffffffffffffffffffffffffff1663fd864ccf826000600661291a617bbb565b6000612c236169a7565b73ffffffffffffffffffffffffffffffffffffffff166332608039836040518263ffffffff1660e01b8152600401808281526020019150506020604051808303818680610f1a617c0c565b600080612c79617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a612cb5617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614612d21576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602f815260200180617eaf602f913960400191505060405180910390fd5b6000806002612d2e617cea565b5050506000600360006101000a81612d44617bbb565b8160ff02191690831515021790612d59617cea565b50506040517f6adcc7125002935e0aa31697538ebbd65cfddf20431eb6ecdcfc3e238bfd082c9150600090a1565b600080612d92617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a612dce617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614612e3a576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602f815260200180617eaf602f913960400191505060405180910390fd5b80600b61010081612e49617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790612e85617cea565b5060009150505b600d80612e97617bbb565b9050811015613020576000600d8281612eae617bbb565b8110612eb657fe5b90600052602060002001612ec8617bbb565b90506001600b612ed6617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663dacb2d01826040518263ffffffff1660e01b81526004018082815260200180602001828103825260178152602001807f5265736f6c766572206d697373696e6720746172676574000000000000000000815250602001925050506020604051808303818680612f77617c0c565b158015612f8357600080fd5b505a612f8d617c56565b5050505050158015612fa3573d6000803e3d6000fd5b505050506040513d6020811015612fb957600080fd5b50516000828152600c60205260409020600181612fd4617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790613010617cea565b505060019092019150612e8c9050565b5050565b60006001610e79617bbb565b600073ffffffffffffffffffffffffffffffffffffffff82166001600b613055617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161461309557506000610f61565b60005b600d806130a3617bbb565b9050811015613249576000600d82816130ba617bbb565b81106130c257fe5b906000526020600020016130d4617bbb565b6000818152600c60205260408120919250906130ee617bbb565b73ffffffffffffffffffffffffffffffffffffffff6101009290920a9004166001600b613119617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166321f8a721836040518263ffffffff1660e01b8152600401808281526020019150506020604051808303818680613181617c0c565b15801561318d57600080fd5b505a613197617c56565b50505050501580156131ad573d6000803e3d6000fd5b505050506040513d60208110156131c357600080fd5b505173ffffffffffffffffffffffffffffffffffffffff1614158061323057506000818152600c6020526040812081906131fb617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16145b1561324057600092505050610f61565b50600101613098565b50600192915050565b600061325c6169a7565b73ffffffffffffffffffffffffffffffffffffffff1663db2b91cf8360006007613284617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166370a08231866040518263ffffffff1660e01b8152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019150506020604051808303818680613318617c0c565b15801561332457600080fd5b505a61332e617c56565b5050505050158015613344573d6000803e3d6000fd5b505050506040513d602081101561335a57600080fd5b5051604080517fffffffff0000000000000000000000000000000000000000000000000000000060e086901b16815273ffffffffffffffffffffffffffffffffffffffff909316600484015260248301919091528051604480840193829003018186806133c5617c0c565b1580156133d157600080fd5b505a6133db617c56565b50505050501580156133f1573d6000803e3d6000fd5b505050506040513d604081101561340757600080fd5b505192915050565b613417616d8c565b73ffffffffffffffffffffffffffffffffffffffff165a613436617cc6565b73ffffffffffffffffffffffffffffffffffffffff16146134b857604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601e60248201527f4f6e6c792045786368616e6765722063616e20696e766f6b6520746869730000604482015290519081900360640190fd5b600060046134c4617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663907dff978686868686604051602001808681526020018581526020018481526020018381526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019550505050505060405160208183030381529060405260026040518080617e4b603e9139603e019050604051809103902061358c8b617322565b6000806040518763ffffffff1660e01b815260040180806020018781526020018681526020018581526020018460001b81526020018360001b8152602001828103825288818151815260200191508051906020019080838360005b838110156135ff5781810151838201526020016135e7565b50505050905090810190601f16801561362c5780820380516001836020036101000a031916815260200191505b509750505050505050506000604051808303816000878061364b617c0c565b15801561365757600080fd5b505a613661617d3a565b505050505050158015613678573d6000803e3d6000fd5b50505050505050505050565b61368c616d8c565b73ffffffffffffffffffffffffffffffffffffffff165a6136ab617cc6565b73ffffffffffffffffffffffffffffffffffffffff161461372d57604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601e60248201527f4f6e6c792045786368616e6765722063616e20696e766f6b6520746869730000604482015290519081900360640190fd5b60006004613739617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663907dff978383604051602001808381526020018281526020019250505060405160208183030381529060405260026040518080617f2260279139602701905060405180910390206137bd88617322565b6000806040518763ffffffff1660e01b815260040180806020018781526020018681526020018581526020018460001b81526020018360001b8152602001828103825288818151815260200191508051906020019080838360005b83811015613830578181015183820152602001613818565b50505050905090810190601f16801561385d5780820380516001836020036101000a031916815260200191505b509750505050505050506000604051808303816000878061387c617c0c565b15801561388857600080fd5b505a613892617d3a565b5050505050501580156138a9573d6000803e3d6000fd5b50505050505050565b60008060076138bf617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166370a08231836040518263ffffffff1660e01b8152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019150506020604051808303818680610f1a617c0c565b606061395d6169a7565b73ffffffffffffffffffffffffffffffffffffffff166372cb051f6040518163ffffffff1660e01b8152600401600060405180830381868061399d617c0c565b1580156139a957600080fd5b505a6139b3617c56565b50505050501580156139c9573d6000803e3d6000fd5b505050506040513d6000823e601f3d9081017fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe01682016040526020811015613a1057600080fd5b8101908080516040519392919084640100000000821115613a3057600080fd5b908301906020820185811115613a4557600080fd5b8251866020820283011164010000000082111715613a6257600080fd5b82525081516020918201928201910280838360005b83811015613a8f578181015183820152602001613a77565b50505050905001604052505050905090565b60006001613aad617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a613ae9617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614613b55576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401808060200182810382526035815260200180617dee6035913960400191505060405180910390fd5b7fb532073b38c83145e3e5135377a08bf9aab55bc0fd7c1179cd4fb995d2a5159c600080613b81617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff166001600090613bab617bbb565b6040805173ffffffffffffffffffffffffffffffffffffffff94851681526101009390930a909104909216602082015281519081900390910190a160006001613bf2617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff166000806101000a81613c1f617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790613c5b617cea565b5050506000600160006101000a81613c71617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790613cad617cea565b505050565b6000613cbc6169a7565b73ffffffffffffffffffffffffffffffffffffffff1663835e119c836040518263ffffffff1660e01b8152600401808281526020019150506020604051808303818680610f1a617c0c565b6000613d116169a7565b73ffffffffffffffffffffffffffffffffffffffff16637b1001b78360006040518363ffffffff1660e01b81526004018083815260200182151515158152602001925050506020604051808303818680610f1a617c0c565b613d71616b0c565b73ffffffffffffffffffffffffffffffffffffffff16637c3125416040518163ffffffff1660e01b81526004016000604051808303818680613db1617c0c565b158015613dbd57600080fd5b505a613dc7617c56565b5050505050158015613ddd573d6000803e3d6000fd5b505050506004600090613dee617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a613e2a617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614158015613eaa575060006005613e55617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a613e91617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614155b8015613f1257505a613eba617cc6565b73ffffffffffffffffffffffffffffffffffffffff1660006006613edc617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614155b15613f6d575a613f20617cc6565b6006600181613f2d617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790613f69617cea565b5050505b613f756169a7565b73ffffffffffffffffffffffffffffffffffffffff1663042e0688600060066125f6617bbb565b600080610e79617bbb565b7f735553440000000000000000000000000000000000000000000000000000000081565b600980613fd6617bbb565b600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280614011617bbb565b600181600116156101000203166002900480156110185780601f1061403d576101008083610fd8617bbb565b820191906000526020600020905b81614054617bbb565b8152906001019060200180831161404b5750859350505050565b600080614079617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a6140b5617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614614121576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602f815260200180617eaf602f913960400191505060405180910390fd5b80600460018161412f617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179061416b617cea565b50506040805173ffffffffffffffffffffffffffffffffffffffff8416815290517ffc80377ca9c49cc11ae6982f390a42db976d5530af7c43889264b13fbbd7c57e92509081900360200190a150565b6141c3616b0c565b73ffffffffffffffffffffffffffffffffffffffff16637c3125416040518163ffffffff1660e01b81526004016000604051808303818680614203617c0c565b15801561420f57600080fd5b505a614219617c56565b505050505015801561422f573d6000803e3d6000fd5b505050506004600090614240617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a61427c617cc6565b73ffffffffffffffffffffffffffffffffffffffff16141580156142fc5750600060056142a7617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a6142e3617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614155b801561436457505a61430c617cc6565b73ffffffffffffffffffffffffffffffffffffffff166000600661432e617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614155b156143bf575a614372617cc6565b600660018161437f617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217906143bb617cea565b5050505b6143c76169a7565b73ffffffffffffffffffffffffffffffffffffffff1663497d704a600060066143ee617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff166040518263ffffffff1660e01b8152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060006040518083038160008780614468617c0c565b15801561447457600080fd5b505a61447e617d3a565b505050505050158015611c88573d6000803e3d6000fd5b600080808060046144a4617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a6144e0617cc6565b73ffffffffffffffffffffffffffffffffffffffff161415801561456057506000600561450b617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a614547617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614155b80156145c857505a614570617cc6565b73ffffffffffffffffffffffffffffffffffffffff1660006006614592617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614155b15614623575a6145d6617cc6565b60066001816145e3617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179061461f617cea565b5050505b61462b616d8c565b73ffffffffffffffffffffffffffffffffffffffff16631b16802c60006006614652617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff16866040518363ffffffff1660e01b8152600401808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200182815260200192505050606060405180830381600087806146d4617c0c565b1580156146e057600080fd5b505a6146ea617d3a565b50505050505015801561135e573d6000803e3d6000fd5b60008061470c617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a614748617cc6565b73ffffffffffffffffffffffffffffffffffffffff16146147b4576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602f815260200180617eaf602f913960400191505060405180910390fd5b600060036147c0617bbb565b906101000a900460ff1661483557604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601f60248201527f53656c66204465737472756374206e6f742079657420696e6974696174656400604482015290519081900360640190fd5b5a61483e617daa565b6224ea00600261484c617bbb565b01106148b957604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601b60248201527f53656c662064657374727563742064656c6179206e6f74206d65740000000000604482015290519081900360640190fd5b7f8a09e1677ced846cb537dc2b172043bd05a1a81ad7e0033a7ef8ba762df990b7600160036148e6617bbb565b604080516101009390930a90910473ffffffffffffffffffffffffffffffffffffffff168252516020918190039190910190a160016003614925617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16ff5b60006005610e79617bbb565b60006004614972617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a6149ae617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614158015614a2e5750600060056149d9617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a614a15617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614155b8015614a9657505a614a3e617cc6565b73ffffffffffffffffffffffffffffffffffffffff1660006006614a60617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614155b15614af1575a614aa4617cc6565b6006600181614ab1617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790614aed617cea565b5050505b600080614afc617bbb565b73ffffffffffffffffffffffffffffffffffffffff6101009290920a90041660006006614b27617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614614bc657604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601360248201527f4f776e6572206f6e6c792066756e6374696f6e00000000000000000000000000604482015290519081900360640190fd5b806007600181614bd4617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790614c10617cea565b5050506126aa8161733b565b6000614c266169a7565b73ffffffffffffffffffffffffffffffffffffffff1663a311c7c2836040518263ffffffff1660e01b8152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019150506020604051808303818680610f1a617c0c565b6224ea0081565b6000614cae6169a7565b73ffffffffffffffffffffffffffffffffffffffff1663a5fdc5de836040518263ffffffff1660e01b8152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019150506020604051808303818680610f1a617c0c565b6000806004614d32617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a614d6e617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614158015614dee575060006005614d99617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a614dd5617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614155b8015614e5657505a614dfe617cc6565b73ffffffffffffffffffffffffffffffffffffffff1660006006614e20617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614155b15614eb1575a614e64617cc6565b6006600181614e71617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790614ead617cea565b5050505b614eb9616b0c565b73ffffffffffffffffffffffffffffffffffffffff1663086dabd16040518163ffffffff1660e01b81526004016000604051808303818680614ef9617c0c565b158015614f0557600080fd5b505a614f0f617c56565b5050505050158015614f25573d6000803e3d6000fd5b50505050614f5c6006600090614f39617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1683616ded565b506112a460006006614f6c617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff168484617498565b614f98617dce565b60005b600d80614fa6617bbb565b9050811015614fee57600d8181614fbb617bbb565b8110614fc357fe5b90600052602060002001614fd5617bbb565b828260188110614fe157fe5b6020020152600101614f9b565b5090565b614ffa616d8c565b73ffffffffffffffffffffffffffffffffffffffff165a615019617cc6565b73ffffffffffffffffffffffffffffffffffffffff161461509b57604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601e60248201527f4f6e6c792045786368616e6765722063616e20696e766f6b6520746869730000604482015290519081900360640190fd5b600060046150a7617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663907dff978383604051602001808381526020018281526020019250505060405160208183030381529060405260026040518080617e2360289139602801905060405180910390206137bd88617322565b615133616b0c565b73ffffffffffffffffffffffffffffffffffffffff16637c3125416040518163ffffffff1660e01b81526004016000604051808303818680615173617c0c565b15801561517f57600080fd5b505a615189617c56565b505050505015801561519f573d6000803e3d6000fd5b5050505060046000906151b0617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a6151ec617cc6565b73ffffffffffffffffffffffffffffffffffffffff161415801561526c575060006005615217617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a615253617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614155b80156152d457505a61527c617cc6565b73ffffffffffffffffffffffffffffffffffffffff166000600661529e617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614155b1561532f575a6152e2617cc6565b60066001816152ef617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179061532b617cea565b5050505b6153376169a7565b73ffffffffffffffffffffffffffffffffffffffff1663c8977132600060066143ee617bbb565b600060036129d8617bbb565b60006004615376617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a6153b2617cc6565b73ffffffffffffffffffffffffffffffffffffffff16148061542f5750600060056153db617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a615417617cc6565b73ffffffffffffffffffffffffffffffffffffffff16145b61549a57604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601760248201527f4f6e6c79207468652070726f78792063616e2063616c6c000000000000000000604482015290519081900360640190fd5b806006600181611c4c617bbb565b6000806154b3617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a6154ef617cc6565b73ffffffffffffffffffffffffffffffffffffffff161461555b576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602f815260200180617eaf602f913960400191505060405180910390fd5b5a615564617daa565b80600261556f617cea565b5050506001600360006101000a81615585617bbb565b8160ff0219169083151502179061559a617cea565b5050604080516224ea00815290517fcbd94ca75b8dc45c9d80c77e851670e78843c0d75180cb81db3e2158228fa9a692509081900360200190a1565b6155de616b0c565b73ffffffffffffffffffffffffffffffffffffffff16637c3125416040518163ffffffff1660e01b8152600401600060405180830381868061561e617c0c565b15801561562a57600080fd5b505a615634617c56565b505050505015801561564a573d6000803e3d6000fd5b50505050600460009061565b617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a615697617cc6565b73ffffffffffffffffffffffffffffffffffffffff16141580156157175750600060056156c2617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a6156fe617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614155b801561577f57505a615727617cc6565b73ffffffffffffffffffffffffffffffffffffffff1660006006615749617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614155b156157da575a61578d617cc6565b600660018161579a617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217906157d6617cea565b5050505b6157e26169a7565b73ffffffffffffffffffffffffffffffffffffffff16639a5154b4836000600661580a617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff16846040518463ffffffff1660e01b8152600401808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018281526020019350505050600060405180830381600087806158bf617c0c565b1580156158cb57600080fd5b505a6158d5617d3a565b5050505050501580156158ec573d6000803e3d6000fd5b505050505050565b60016003610e79617bbb565b600d818161590c617bbb565b811061591457fe5b60009182526020909120019050611e65617bbb565b60008382615935616b0c565b73ffffffffffffffffffffffffffffffffffffffff16637118d4316040518163ffffffff1660e01b81526004016000604051808303818680615975617c0c565b15801561598157600080fd5b505a61598b617c56565b50505050501580156159a1573d6000803e3d6000fd5b505050506159ad616b0c565b73ffffffffffffffffffffffffffffffffffffffff16636132eba483836040518363ffffffff1660e01b815260040180838152602001828152602001925050506000604051808303818680615a00617c0c565b158015615a0c57600080fd5b505a615a16617c56565b5050505050158015615a2c573d6000803e3d6000fd5b505050506004600090615a3d617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a615a79617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614158015615af9575060006005615aa4617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a615ae0617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614155b8015615b6157505a615b09617cc6565b73ffffffffffffffffffffffffffffffffffffffff1660006006615b2b617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614155b15615bbc575a615b6f617cc6565b6006600181615b7c617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790615bb8617cea565b5050505b615bc4616d8c565b73ffffffffffffffffffffffffffffffffffffffff16636a1c47588860006006615bec617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff168989896040518663ffffffff1660e01b8152600401808673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018481526020018381526020018281526020019550505050505060206040518083038160008780615cb1617c0c565b158015615cbd57600080fd5b505a615cc7617d3a565b505050505050158015615cde573d6000803e3d6000fd5b505050506040513d6020811015615cf457600080fd5b5051979650505050505050565b6000615d0b6169a7565b73ffffffffffffffffffffffffffffffffffffffff1663d37c4d8b84846040518363ffffffff1660e01b8152600401808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001828152602001925050506020604051808303818680615d8a617c0c565b158015615d9657600080fd5b505a615da0617c56565b5050505050158015615db6573d6000803e3d6000fd5b505050506040513d6020811015615dcc57600080fd5b50519392505050565b6000615ddf6169a7565b73ffffffffffffffffffffffffffffffffffffffff16637b1001b78360016040518363ffffffff1660e01b81526004018083815260200182151515158152602001925050506020604051808303818680610f1a617c0c565b60006006610e79617bbb565b6000615e4d6169a7565b73ffffffffffffffffffffffffffffffffffffffff1663dbf633406040518163ffffffff1660e01b81526004016020604051808303818680615e8d617c0c565b158015615e9957600080fd5b505a615ea3617c56565b5050505050158015615eb9573d6000803e3d6000fd5b505050506040513d6020811015615ecf57600080fd5b5051905090565b6000806007615ee3617bbb565b604080517fdd62ed3e00000000000000000000000000000000000000000000000000000000815273ffffffffffffffffffffffffffffffffffffffff8781166004830152868116602483015291516101009490940a909204169163dd62ed3e9160448082019260209290919082900301818680615d8a617c0c565b601881565b6000615f6d616b0c565b73ffffffffffffffffffffffffffffffffffffffff1663086dabd16040518163ffffffff1660e01b81526004016000604051808303818680615fad617c0c565b158015615fb957600080fd5b505a615fc3617c56565b5050505050158015615fd9573d6000803e3d6000fd5b505050506004600090615fea617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a616026617cc6565b73ffffffffffffffffffffffffffffffffffffffff16141580156160a6575060006005616051617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a61608d617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614155b801561610e57505a6160b6617cc6565b73ffffffffffffffffffffffffffffffffffffffff16600060066160d8617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614155b15616169575a61611c617cc6565b6006600181616129617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790616165617cea565b5050505b6000806161746169a7565b73ffffffffffffffffffffffffffffffffffffffff1663a63c4df486866000600661619d617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff166040518463ffffffff1660e01b8152600401808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018381526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019350505050604080518083038160008780616250617c0c565b15801561625c57600080fd5b505a616266617d3a565b50505050505015801561627d573d6000803e3d6000fd5b505050506040513d604081101561629357600080fd5b50805160209091015190925090506162d5858383600060066162b3617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff166174a5565b61630885600060066162e5617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1684617498565b95945050505050565b616319616b0c565b73ffffffffffffffffffffffffffffffffffffffff16637c3125416040518163ffffffff1660e01b81526004016000604051808303818680616359617c0c565b15801561636557600080fd5b505a61636f617c56565b5050505050158015616385573d6000803e3d6000fd5b505050506004600090616396617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a6163d2617cc6565b73ffffffffffffffffffffffffffffffffffffffff16141580156164525750600060056163fd617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a616439617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614155b80156164ba57505a616462617cc6565b73ffffffffffffffffffffffffffffffffffffffff1660006006616484617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614155b15616515575a6164c8617cc6565b60066001816164d5617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790616511617cea565b5050505b61651d6169a7565b73ffffffffffffffffffffffffffffffffffffffff166344ec6b62836000600661580a617bbb565b60006007610e79617bbb565b60006004610e79617bbb565b60008382616569616b0c565b73ffffffffffffffffffffffffffffffffffffffff16637118d4316040518163ffffffff1660e01b815260040160006040518083038186806165a9617c0c565b1580156165b557600080fd5b505a6165bf617c56565b50505050501580156165d5573d6000803e3d6000fd5b505050506165e1616b0c565b73ffffffffffffffffffffffffffffffffffffffff16636132eba483836040518363ffffffff1660e01b815260040180838152602001828152602001925050506000604051808303818680616634617c0c565b15801561664057600080fd5b505a61664a617c56565b5050505050158015616660573d6000803e3d6000fd5b505050506004600090616671617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a6166ad617cc6565b73ffffffffffffffffffffffffffffffffffffffff161415801561672d5750600060056166d8617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a616714617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614155b801561679557505a61673d617cc6565b73ffffffffffffffffffffffffffffffffffffffff166000600661675f617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614155b156167f0575a6167a3617cc6565b60066001816167b0617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217906167ec617cea565b5050505b6167f8616d8c565b73ffffffffffffffffffffffffffffffffffffffff16630a1e187d6000600661681f617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff16888888600660009061684c617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff166040518663ffffffff1660e01b8152600401808673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018581526020018481526020018381526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001955050505050506020604051808303816000878061690e617c0c565b15801561691a57600080fd5b505a616924617d3a565b50505050505015801561693b573d6000803e3d6000fd5b505050506040513d602081101561695157600080fd5b50519695505050505050565b60006169676169a7565b73ffffffffffffffffffffffffffffffffffffffff1663f354cad16040518163ffffffff1660e01b81526004016020604051808303818680615e8d617c0c565b6000616a087f49737375657200000000000000000000000000000000000000000000000000006040518060400160405280601681526020017f4d697373696e672049737375657220616464726573730000000000000000000081525061765f565b905090565b60006004616a19617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663907dff97826040516020018082815260200191505060405160208183030381529060405260036040518080617ede6021913960210190506040518091039020616a9588617322565b616a9e88617322565b60006040518763ffffffff1660e01b815260040180806020018781526020018681526020018581526020018481526020018360001b81526020018281038252888181518152602001915080519060200190808383600083811015613830578181015183820152602001613818565b6000616a087f53797374656d53746174757300000000000000000000000000000000000000006040518060400160405280601c81526020017f4d697373696e672053797374656d53746174757320616464726573730000000081525061765f565b6000616a087f52657761726473446973747269627574696f6e00000000000000000000000000604051806060016040528060238152602001617eff6023913961765f565b6000616a087f537570706c795363686564756c650000000000000000000000000000000000006040518060400160405280601e81526020017f4d697373696e6720537570706c795363686564756c652061646472657373000081525061765f565b600082821115616c8357604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601e60248201527f536166654d6174683a207375627472616374696f6e206f766572666c6f770000604482015290519081900360640190fd5b50900390565b600082820183811015616cfd57604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601b60248201527f536166654d6174683a206164646974696f6e206f766572666c6f770000000000604482015290519081900360640190fd5b9392505050565b60006004616d10617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663907dff97826040516020018082815260200191505060405160208183030381529060405260036040518080617f7b6021913960210190506040518091039020616a9588617322565b6000616a087f45786368616e67657200000000000000000000000000000000000000000000006040518060400160405280601981526020017f4d697373696e672045786368616e67657220616464726573730000000000000081525061765f565b600080616df8617746565b604080517f8b3f808800000000000000000000000000000000000000000000000000000000815273ffffffffffffffffffffffffffffffffffffffff87811660048301528251931692638b3f80889260248084019391929182900301818680616e5f617c0c565b158015616e6b57600080fd5b505a616e75617c56565b5050505050158015616e8b573d6000803e3d6000fd5b505050506040513d6040811015616ea157600080fd5b5051905080156112a457600080616eb66169a7565b73ffffffffffffffffffffffffffffffffffffffff1663db2b91cf8760006007616ede617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166370a082318a6040518263ffffffff1660e01b8152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019150506020604051808303818680616f72617c0c565b158015616f7e57600080fd5b505a616f88617c56565b5050505050158015616f9e573d6000803e3d6000fd5b505050506040513d6020811015616fb457600080fd5b5051604080517fffffffff0000000000000000000000000000000000000000000000000000000060e086901b16815273ffffffffffffffffffffffffffffffffffffffff9093166004840152602483019190915280516044808401938290030181868061701f617c0c565b15801561702b57600080fd5b505a617035617c56565b505050505015801561704b573d6000803e3d6000fd5b505050506040513d604081101561706157600080fd5b5080516020909101519092509050818511156170c8576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401808060200182810382526026815260200180617e896026913960400191505060405180910390fd5b801561713557604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601c60248201527f412073796e7468206f7220534e582072617465206973207374616c6500000000604482015290519081900360640190fd5b50600195945050505050565b600080600761714e617bbb565b73ffffffffffffffffffffffffffffffffffffffff6101009290920a90041663da46098c858761724f8660006007617184617bbb565b604080517fdd62ed3e00000000000000000000000000000000000000000000000000000000815273ffffffffffffffffffffffffffffffffffffffff8e811660048301528f8116602483015291516101009490940a909204169163dd62ed3e91604480820192602092909190829003018186806171ff617c0c565b15801561720b57600080fd5b505a617215617c56565b505050505015801561722b573d6000803e3d6000fd5b505050506040513d602081101561724157600080fd5b50519063ffffffff616c1216565b6040518463ffffffff1660e01b8152600401808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018281526020019350505050600060405180830381600087806172e6617c0c565b1580156172f257600080fd5b505a6172fc617d3a565b505050505050158015617313573d6000803e3d6000fd5b505050506163088484846177a7565b73ffffffffffffffffffffffffffffffffffffffff1690565b60006004617347617bbb565b6040805173ffffffffffffffffffffffffffffffffffffffff8581166020808401919091528351808403820181528385018086527f546f6b656e5374617465557064617465642861646472657373290000000000009052935192839003605a0183207f907dff97000000000000000000000000000000000000000000000000000000008452600160248501819052604485018290526000606486018190526084860181905260a4860181905260c060048701908152875160c488015287516101009a909a0a909804949094169763907dff979791959294938493849392839260e4909201918a0190808383885b8381101561744c578181015183820152602001617434565b50505050905090810190601f1680156174795780820380516001836020036101000a031916815260200191505b5097505050505050505060006040518083038160008780612678617c0c565b60006123bb8484846177a7565b600060046174b1617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663907dff97848484604051602001808481526020018381526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001935050505060405160208183030381529060405260026040518080617f49603291396032019050604051809103902061756989617322565b6000806040518763ffffffff1660e01b815260040180806020018781526020018681526020018581526020018460001b81526020018360001b8152602001828103825288818151815260200191508051906020019080838360005b838110156175dc5781810151838201526020016175c4565b50505050905090810190601f1680156176095780820380516001836020036101000a031916815260200191505b5097505050505050505060006040518083038160008780617628617c0c565b15801561763457600080fd5b505a61763e617d3a565b505050505050158015617655573d6000803e3d6000fd5b5050505050505050565b6000828152600c6020526040812081908190617679617bbb565b73ffffffffffffffffffffffffffffffffffffffff6101009290920a9004169050828161773e576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825283818151815260200191508051906020019080838360005b838110156177035781810151838201526020016176eb565b50505050905090810190601f1680156177305780820380516001836020036101000a031916815260200191505b509250505060405180910390fd5b509392505050565b6000616a087f53796e74686574697853746174650000000000000000000000000000000000006040518060400160405280601e81526020017f4d697373696e672053796e74686574697853746174652061646472657373000081525061765f565b600073ffffffffffffffffffffffffffffffffffffffff83161580159061781057505a63996d79a5620800008160e01b81526020816004836000335af1806177ee57600080fd5b505173ffffffffffffffffffffffffffffffffffffffff868116911614159150505b8015617870575060006004617823617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff1614155b6178db57604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601f60248201527f43616e6e6f74207472616e7366657220746f2074686973206164647265737300604482015290519081900360640190fd5b600060076178e7617bbb565b73ffffffffffffffffffffffffffffffffffffffff6101009290920a90041663b46310f6856179b0856000600761791c617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166370a082318a6040518263ffffffff1660e01b8152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060206040518083038186806171ff617c0c565b6040518363ffffffff1660e01b8152600401808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018281526020019250505060006040518083038160008780617a14617c0c565b158015617a2057600080fd5b505a617a2a617d3a565b505050505050158015617a41573d6000803e3d6000fd5b505050506007600090617a52617bbb565b73ffffffffffffffffffffffffffffffffffffffff6101009290920a90041663b46310f684617b1b8560006007617a87617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166370a08231896040518263ffffffff1660e01b8152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060206040518083038186806117df617c0c565b6040518363ffffffff1660e01b8152600401808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018281526020019250505060006040518083038160008780617b7f617c0c565b158015617b8b57600080fd5b505a617b95617d3a565b505050505050158015617bac573d6000803e3d6000fd5b505050506112a4848484616d04565b7f209662080000000000000000000000000000000000000000000000000000000062080000908152620800048390526320966208906020816024816000335af180617c0557600080fd5b5051925050565b7fc3382d0f00000000000000000000000000000000000000000000000000000000620800009081526208000483905263c3382d0f906020816024816000335af180617c0557600080fd5b7ffbb0f79d00000000000000000000000000000000000000000000000000000000620800009081526208000484905263fbb0f79d9060005b87811015617ca9578681015182820160240152602001617c8e565b50888888602401836000335af180617cc057600080fd5b98505050565b6373509064620800008160e01b81526020816004836000335af180617c0557600080fd5b7f28dcb2a0000000000000000000000000000000000000000000000000000000006208000090815262080004839052620800248490526328dcb2a09060008160448183335af180613cad57600080fd5b7f4c6d7c84000000000000000000000000000000000000000000000000000000006208000090815262080004849052634c6d7c849060005b88811015617d8d578781015182820160240152602001617d72565b50898989602401836000335af180617da457600080fd5b99505050565b63bdbf8c36620800008160e01b81526020816004836000335af180617c0557600080fd5b604051806103000160405280601890602082028038833950919291505056fe596f75206d757374206265206e6f6d696e61746564206265666f726520796f752063616e20616363657074206f776e65727368697045786368616e67655265636c61696d28616464726573732c627974657333322c75696e743235362953796e746845786368616e676528616464726573732c627974657333322c75696e743235362c627974657333322c75696e743235362c616464726573732943616e6e6f74207472616e73666572207374616b6564206f7220657363726f77656420534e584f6e6c792074686520636f6e7472616374206f776e6572206d617920706572666f726d207468697320616374696f6e417070726f76616c28616464726573732c616464726573732c75696e74323536294d697373696e672052657761726473446973747269627574696f6e206164647265737345786368616e676552656261746528616464726573732c627974657333322c75696e74323536294163636f756e744c69717569646174656428616464726573732c75696e743235362c75696e743235362c61646472657373295472616e7366657228616464726573732c616464726573732c75696e7432353629a265627a7a72315820c928209c56849c6a20bd37206a12ebc76794bf68ede11216041255d5c8d5786c64736f6c637828302e352e31362d646576656c6f702e323032302e372e32392b636f6d6d69742e36326536346536370058'
          const synthetixInitcode = '0x' + synthetixInitcodeRaw
    it.only('Gas cost for synthetix construction code safety check', async () => {

      
      const data = await safetyChecker.interface.encodeFunctionData(
        'isBytecodeSafe',
        [synthetixInitcode]
      )
      const tx = {
        to: safetyChecker.address,
        data
      }

      console.log(`contract is ${synthetixInitcode.length/2} bytes long`)

      // THIS IS THE NUMBER WE WANT TO GO DOWN--average per-byte cost of a safety check should go down.
      const res = await safetyChecker.provider.estimateGas(tx)
      console.log(`estimate gas result for synthetix initcode: ${res}`)

      const isSAfe: boolean = await safetyChecker.isBytecodeSafe(synthetixInitcode)
      console.log(`and is it safe? ${isSAfe}`)

      console.log(`expected calldata cost is ${getTxCalldataGasCostForConsumeGas(synthetixInitcode)}`)

    })
    const synthetixDeployedBytecode = '608060405234801561001057600080fd5b50600436106104725760003560e01c80638da5cb5b11610250578063bc67f83211610150578063dbf63340116100c8578063e8e09b8b11610097578063ec5568891161007c578063ec55688914610e34578063ee52a2f314610e3c578063f354cad114610e6557610472565b8063e8e09b8b14610df3578063e90dd9e214610e2c57610472565b8063dbf6334014610d6f578063dd62ed3e14610d77578063e3235c9114610db2578063e6203ed114610dba57610472565b8063c6c9d8281161011f578063d37c4d8b11610104578063d37c4d8b14610d11578063d60888e414610d4a578063d67bdd2514610d6757610472565b8063c6c9d82814610caf578063c836fa0a14610ccc57610472565b8063bc67f83214610c33578063bd32aa4414610c66578063c2bf388014610c6e578063c58aaae614610ca757610472565b80639f769807116101e3578063a9059cbb116101b2578063ace88afd11610197578063ace88afd14610be4578063af086c7e14610c23578063b8225dec14610c2b57610472565b8063a9059cbb14610b6a578063ab49848c14610ba357610472565b80639f76980714610ac9578063a311c7c214610afc578063a461fc8214610b2f578063a5fdc5de14610b3757610472565b80639741fb221161021f5780639741fb2214610a94578063987757dd14610a9c5780639cb8a26a14610ab95780639cbdaeb614610ac157610472565b80638da5cb5b14610a495780639324cac714610a5157806395d89b4114610a5957806397107d6d14610a6157610472565b80632c955fa7116103765780636ac0bf9c116102ee57806372cb051f116102bd578063835e119c116102a2578063835e119c146109f257806383d625d414610a0f5780638a29001414610a2c57610472565b806372cb051f1461099257806379ba5097146109ea57610472565b80636ac0bf9c1461089a5780636c00f310146108cd5780636f01a9861461092057806370a082311461095f57610472565b806332608039116103455780633be99e6f1161032a5780633be99e6f1461082c57806353a47bb71461085f578063631e14441461086757610472565b806332608039146108075780633278c9601461082457610472565b80632c955fa71461077b5780632e0f2625146107ae578063313ce567146107cc578063320223db146107d457610472565b806316b2213f116104095780631fce304d116103d857806323b872dd116103bd57806323b872dd14610713578063295da87d146107565780632a9053181461077357610472565b80631fce304d146106c357806320714f88146106e057610472565b806316b2213f1461067857806317c70de4146106ab57806318160ddd146106b357806318821400146106bb57610472565b80631137aedf116104455780631137aedf146105b75780631249c58b14610608578063131b0ae7146106105780631627540c1461064557610472565b806304f3bcec1461047757806305b3c1c9146104a857806306fdde03146104ed578063095ea7b31461056a575b600080fd5b61047f610e6d565b6040805173ffffffffffffffffffffffffffffffffffffffff9092168252519081900360200190f35b6104db600480360360208110156104be57600080fd5b503573ffffffffffffffffffffffffffffffffffffffff16610e99565b60408051918252519081900360200190f35b6104f5610f66565b6040805160208082528351818301528351919283929083019185019080838360005b8381101561052f578181015183820152602001610517565b50505050905090810190601f16801561055c5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6105a36004803603604081101561058057600080fd5b5073ffffffffffffffffffffffffffffffffffffffff8135169060200135611020565b604080519115158252519081900360200190f35b6105ea600480360360208110156105cd57600080fd5b503573ffffffffffffffffffffffffffffffffffffffff166112ae565b60408051938452602084019290925282820152519081900360600190f35b6105a361138e565b6106436004803603602081101561062657600080fd5b503573ffffffffffffffffffffffffffffffffffffffff16611b8b565b005b6106436004803603602081101561065b57600080fd5b503573ffffffffffffffffffffffffffffffffffffffff16611c8e565b6104db6004803603602081101561068e57600080fd5b503573ffffffffffffffffffffffffffffffffffffffff16611dda565b6104db611e5b565b6104db611e68565b6104f5611e72565b6105a3600480360360208110156106d957600080fd5b5035611eab565b610643600480360360208110156106f657600080fd5b503573ffffffffffffffffffffffffffffffffffffffff16611fa8565b6105a36004803603606081101561072957600080fd5b5073ffffffffffffffffffffffffffffffffffffffff813581169160208101359091169060400135612178565b6106436004803603602081101561076c57600080fd5b50356123c3565b6104f56126ad565b6106436004803603602081101561079157600080fd5b503573ffffffffffffffffffffffffffffffffffffffff166126e6565b6107b66129c7565b6040805160ff9092168252519081900360200190f35b6107b66129cc565b610643600480360360208110156107ea57600080fd5b503573ffffffffffffffffffffffffffffffffffffffff166129e5565b61047f6004803603602081101561081d57600080fd5b5035612c19565b610643612c6e565b6106436004803603602081101561084257600080fd5b503573ffffffffffffffffffffffffffffffffffffffff16612d87565b61047f613024565b6105a36004803603602081101561087d57600080fd5b503573ffffffffffffffffffffffffffffffffffffffff16613030565b6104db600480360360208110156108b057600080fd5b503573ffffffffffffffffffffffffffffffffffffffff16613252565b610643600480360360c08110156108e357600080fd5b5073ffffffffffffffffffffffffffffffffffffffff813581169160208101359160408201359160608101359160808201359160a001351661340f565b6106436004803603606081101561093657600080fd5b5073ffffffffffffffffffffffffffffffffffffffff8135169060208101359060400135613684565b6104db6004803603602081101561097557600080fd5b503573ffffffffffffffffffffffffffffffffffffffff166138b2565b61099a613953565b60408051602080825283518183015283519192839290830191858101910280838360005b838110156109d65781810151838201526020016109be565b505050509050019250505060405180910390f35b610643613aa1565b61047f60048036036020811015610a0857600080fd5b5035613cb2565b6104db60048036036020811015610a2557600080fd5b5035613d07565b61064360048036036020811015610a4257600080fd5b5035613d69565b61047f613f9c565b6104db613fa7565b6104f5613fcb565b61064360048036036020811015610a7757600080fd5b503573ffffffffffffffffffffffffffffffffffffffff1661406e565b6106436141bb565b6105ea60048036036020811015610ab257600080fd5b5035614495565b610643614701565b61047f61495a565b61064360048036036020811015610adf57600080fd5b503573ffffffffffffffffffffffffffffffffffffffff16614966565b6104db60048036036020811015610b1257600080fd5b503573ffffffffffffffffffffffffffffffffffffffff16614c1c565b6104db614c9d565b6104db60048036036020811015610b4d57600080fd5b503573ffffffffffffffffffffffffffffffffffffffff16614ca4565b6105a360048036036040811015610b8057600080fd5b5073ffffffffffffffffffffffffffffffffffffffff8135169060200135614d25565b610bab614f90565b604051808261030080838360005b83811015610bd1578181015183820152602001610bb9565b5050505090500191505060405180910390f35b61064360048036036060811015610bfa57600080fd5b5073ffffffffffffffffffffffffffffffffffffffff8135169060208101359060400135614ff2565b61064361512b565b6105a361535e565b61064360048036036020811015610c4957600080fd5b503573ffffffffffffffffffffffffffffffffffffffff1661536a565b6106436154a8565b61064360048036036040811015610c8457600080fd5b5073ffffffffffffffffffffffffffffffffffffffff81351690602001356155d6565b61047f6158f4565b6104db60048036036020811015610cc557600080fd5b5035615900565b6104db60048036036080811015610ce257600080fd5b5073ffffffffffffffffffffffffffffffffffffffff8135169060208101359060408101359060600135615929565b6104db60048036036040811015610d2757600080fd5b5073ffffffffffffffffffffffffffffffffffffffff8135169060200135615d01565b6104db60048036036020811015610d6057600080fd5b5035615dd5565b61047f615e37565b6104db615e43565b6104db60048036036040811015610d8d57600080fd5b5073ffffffffffffffffffffffffffffffffffffffff81358116916020013516615ed6565b6104db615f5e565b6105a360048036036040811015610dd057600080fd5b5073ffffffffffffffffffffffffffffffffffffffff8135169060200135615f63565b61064360048036036040811015610e0957600080fd5b5073ffffffffffffffffffffffffffffffffffffffff8135169060200135616311565b61047f616545565b61047f616551565b6104db60048036036060811015610e5257600080fd5b508035906020810135906040013561655d565b6105a361695d565b6001600b610e79617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b6000610ea36169a7565b73ffffffffffffffffffffffffffffffffffffffff166305b3c1c9836040518263ffffffff1660e01b8152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019150506020604051808303818680610f1a617c0c565b158015610f2657600080fd5b505a610f30617c56565b5050505050158015610f46573d6000803e3d6000fd5b505050506040513d6020811015610f5c57600080fd5b505190505b919050565b600880610f71617bbb565b600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280610fac617bbb565b600181600116156101000203166002900480156110185780601f10610fe6576101008083610fd8617bbb565b040283529160200191611018565b820191906000526020600020905b81610ffd617bbb565b81529060010190602001808311610ff457829003601f168201915b505050505081565b600080600461102d617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a611069617cc6565b73ffffffffffffffffffffffffffffffffffffffff16141580156110e9575060006005611094617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a6110d0617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614155b801561115157505a6110f9617cc6565b73ffffffffffffffffffffffffffffffffffffffff166000600661111b617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614155b156111ac575a61115f617cc6565b600660018161116c617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217906111a8617cea565b5050505b60008060066111b9617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff16905060076000906111e5617bbb565b604080517fda46098c00000000000000000000000000000000000000000000000000000000815273ffffffffffffffffffffffffffffffffffffffff858116600483015288811660248301526044820188905291516101009490940a909204169163da46098c916064808201926000929091908290030181838780611268617c0c565b15801561127457600080fd5b505a61127e617d3a565b505050505050158015611295573d6000803e3d6000fd5b505050506112a4818585616a0d565b5060019392505050565b60008060006112bb6169a7565b73ffffffffffffffffffffffffffffffffffffffff16631137aedf856040518263ffffffff1660e01b8152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019150506060604051808303818680611332617c0c565b15801561133e57600080fd5b505a611348617c56565b505050505015801561135e573d6000803e3d6000fd5b505050506040513d606081101561137457600080fd5b508051602082015160409092015190969195509350915050565b6000611398616b0c565b73ffffffffffffffffffffffffffffffffffffffff16637c3125416040518163ffffffff1660e01b815260040160006040518083038186806113d8617c0c565b1580156113e457600080fd5b505a6113ee617c56565b5050505050158015611404573d6000803e3d6000fd5b50505050600073ffffffffffffffffffffffffffffffffffffffff16611428616b6d565b73ffffffffffffffffffffffffffffffffffffffff1614156114ab57604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601b60248201527f52657761726473446973747269627574696f6e206e6f74207365740000000000604482015290519081900360640190fd5b60006114b5616bb1565b905060006114c1616b6d565b905060008273ffffffffffffffffffffffffffffffffffffffff1663cc5c095c6040518163ffffffff1660e01b81526004016020604051808303818680611506617c0c565b15801561151257600080fd5b505a61151c617c56565b5050505050158015611532573d6000803e3d6000fd5b505050506040513d602081101561154857600080fd5b50519050806115b857604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601560248201527f4e6f20737570706c79206973206d696e7461626c650000000000000000000000604482015290519081900360640190fd5b8273ffffffffffffffffffffffffffffffffffffffff16637e7961d7826040518263ffffffff1660e01b81526004018082815260200191505060206040518083038160008780611606617c0c565b15801561161257600080fd5b505a61161c617d3a565b505050505050158015611633573d6000803e3d6000fd5b505050506040513d602081101561164957600080fd5b5050604080517f9bdd7ac7000000000000000000000000000000000000000000000000000000008152905160009173ffffffffffffffffffffffffffffffffffffffff861691639bdd7ac791600480820192602092909190829003018186806116b0617c0c565b1580156116bc57600080fd5b505a6116c6617c56565b50505050501580156116dc573d6000803e3d6000fd5b505050506040513d60208110156116f257600080fd5b505190506000611708838363ffffffff616c1216565b905060006007611716617bbb565b73ffffffffffffffffffffffffffffffffffffffff6101009290920a90041663b46310f68561182f846000600761174b617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166370a082318a6040518263ffffffff1660e01b8152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060206040518083038186806117df617c0c565b1580156117eb57600080fd5b505a6117f5617c56565b505050505015801561180b573d6000803e3d6000fd5b505050506040513d602081101561182157600080fd5b50519063ffffffff616c8916565b6040518363ffffffff1660e01b8152600401808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018281526020019250505060006040518083038160008780611893617c0c565b15801561189f57600080fd5b505a6118a9617d3a565b5050505050501580156118c0573d6000803e3d6000fd5b505050506118f95a63996d79a5620800008160e01b81526020816004836000335af1806118ec57600080fd5b5051915086905083616d04565b8373ffffffffffffffffffffffffffffffffffffffff166359974e38826040518263ffffffff1660e01b81526004018082815260200191505060206040518083038160008780611947617c0c565b15801561195357600080fd5b505a61195d617d3a565b505050505050158015611974573d6000803e3d6000fd5b505050506040513d602081101561198a57600080fd5b50600090506007611999617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663b46310f65a6119da617cc6565b611a8685600060076119ea617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166370a082315a611a2b617cc6565b6040518263ffffffff1660e01b8152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060206040518083038186806117df617c0c565b6040518363ffffffff1660e01b8152600401808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018281526020019250505060006040518083038160008780611aea617c0c565b158015611af657600080fd5b505a611b00617d3a565b505050505050158015611b17573d6000803e3d6000fd5b50505050611b575a63996d79a5620800008160e01b81526020816004836000335af180611b4357600080fd5b50519150505a611b51617cc6565b84616d04565b611b7183600a611b65617bbb565b9063ffffffff616c8916565b80600a611b7c617cea565b50505060019550505050505090565b600080611b96617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a611bd2617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614611c3e576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602f815260200180617eaf602f913960400191505060405180910390fd5b806005600181611c4c617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790611c88617cea565b50505050565b600080611c99617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a611cd5617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614611d41576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602f815260200180617eaf602f913960400191505060405180910390fd5b8060018080611d4e617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790611d8a617cea565b50506040805173ffffffffffffffffffffffffffffffffffffffff8416815290517f906a1c6bd7e3091ea86693dd029a831c19049ce77f1dce2ce0bab1cacbabce2292509081900360200190a150565b6000611de46169a7565b73ffffffffffffffffffffffffffffffffffffffff166316b2213f836040518263ffffffff1660e01b8152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019150506020604051808303818680610f1a617c0c565b6002611e65617bbb565b81565b600a611e65617bbb565b6040518060400160405280601781526020017f53796e746865746978204e6574776f726b20546f6b656e00000000000000000081525081565b600080611eb6616d8c565b73ffffffffffffffffffffffffffffffffffffffff1663059c29ec60006006611edd617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff16856040518363ffffffff1660e01b8152600401808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001828152602001925050506020604051808303818680611f5d617c0c565b158015611f6957600080fd5b505a611f73617c56565b5050505050158015611f89573d6000803e3d6000fd5b505050506040513d6020811015611f9f57600080fd5b50511192915050565b600080611fb3617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a611fef617cc6565b73ffffffffffffffffffffffffffffffffffffffff161461205b576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602f815260200180617eaf602f913960400191505060405180910390fd5b73ffffffffffffffffffffffffffffffffffffffff81166120dd57604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601c60248201527f42656e6566696369617279206d757374206e6f74206265207a65726f00000000604482015290519081900360640190fd5b806003610100816120ec617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790612128617cea565b50506040805173ffffffffffffffffffffffffffffffffffffffff8416815290517fd5da63a0b864b315bc04128dedbc93888c8529ee6cf47ce664dc204339228c5392509081900360200190a150565b6000806004612185617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a6121c1617cc6565b73ffffffffffffffffffffffffffffffffffffffff16141580156122415750600060056121ec617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a612228617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614155b80156122a957505a612251617cc6565b73ffffffffffffffffffffffffffffffffffffffff1660006006612273617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614155b15612304575a6122b7617cc6565b60066001816122c4617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790612300617cea565b5050505b61230c616b0c565b73ffffffffffffffffffffffffffffffffffffffff1663086dabd16040518163ffffffff1660e01b8152600401600060405180830381868061234c617c0c565b15801561235857600080fd5b505a612362617c56565b5050505050158015612378573d6000803e3d6000fd5b505050506123868483616ded565b506123bb60006006612396617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff16858585617141565b949350505050565b6123cb616b0c565b73ffffffffffffffffffffffffffffffffffffffff16637c3125416040518163ffffffff1660e01b8152600401600060405180830381868061240b617c0c565b15801561241757600080fd5b505a612421617c56565b5050505050158015612437573d6000803e3d6000fd5b505050506004600090612448617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a612484617cc6565b73ffffffffffffffffffffffffffffffffffffffff16141580156125045750600060056124af617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a6124eb617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614155b801561256c57505a612514617cc6565b73ffffffffffffffffffffffffffffffffffffffff1660006006612536617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614155b156125c7575a61257a617cc6565b6006600181612587617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217906125c3617cea565b5050505b6125cf6169a7565b73ffffffffffffffffffffffffffffffffffffffff1663b06e8c65600060066125f6617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff16836040518363ffffffff1660e01b8152600401808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018281526020019250505060006040518083038160008780612678617c0c565b15801561268457600080fd5b505a61268e617d3a565b5050505050501580156126a5573d6000803e3d6000fd5b505050505b50565b6040518060400160405280600381526020017f534e58000000000000000000000000000000000000000000000000000000000081525081565b6126ee616b0c565b73ffffffffffffffffffffffffffffffffffffffff16637c3125416040518163ffffffff1660e01b8152600401600060405180830381868061272e617c0c565b15801561273a57600080fd5b505a612744617c56565b505050505015801561275a573d6000803e3d6000fd5b50505050600460009061276b617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a6127a7617cc6565b73ffffffffffffffffffffffffffffffffffffffff16141580156128275750600060056127d2617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a61280e617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614155b801561288f57505a612837617cc6565b73ffffffffffffffffffffffffffffffffffffffff1660006006612859617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614155b156128ea575a61289d617cc6565b60066001816128aa617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217906128e6617cea565b5050505b6128f26169a7565b73ffffffffffffffffffffffffffffffffffffffff16632b3f41aa826000600661291a617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff166040518363ffffffff1660e01b8152600401808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019250505060006040518083038160008780612678617c0c565b601281565b6000600b6129d8617bbb565b906101000a900460ff1681565b6129ed616b0c565b73ffffffffffffffffffffffffffffffffffffffff16637c3125416040518163ffffffff1660e01b81526004016000604051808303818680612a2d617c0c565b158015612a3957600080fd5b505a612a43617c56565b5050505050158015612a59573d6000803e3d6000fd5b505050506004600090612a6a617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a612aa6617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614158015612b26575060006005612ad1617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a612b0d617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614155b8015612b8e57505a612b36617cc6565b73ffffffffffffffffffffffffffffffffffffffff1660006006612b58617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614155b15612be9575a612b9c617cc6565b6006600181612ba9617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790612be5617cea565b5050505b612bf16169a7565b73ffffffffffffffffffffffffffffffffffffffff1663fd864ccf826000600661291a617bbb565b6000612c236169a7565b73ffffffffffffffffffffffffffffffffffffffff166332608039836040518263ffffffff1660e01b8152600401808281526020019150506020604051808303818680610f1a617c0c565b600080612c79617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a612cb5617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614612d21576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602f815260200180617eaf602f913960400191505060405180910390fd5b6000806002612d2e617cea565b5050506000600360006101000a81612d44617bbb565b8160ff02191690831515021790612d59617cea565b50506040517f6adcc7125002935e0aa31697538ebbd65cfddf20431eb6ecdcfc3e238bfd082c9150600090a1565b600080612d92617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a612dce617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614612e3a576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602f815260200180617eaf602f913960400191505060405180910390fd5b80600b61010081612e49617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790612e85617cea565b5060009150505b600d80612e97617bbb565b9050811015613020576000600d8281612eae617bbb565b8110612eb657fe5b90600052602060002001612ec8617bbb565b90506001600b612ed6617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663dacb2d01826040518263ffffffff1660e01b81526004018082815260200180602001828103825260178152602001807f5265736f6c766572206d697373696e6720746172676574000000000000000000815250602001925050506020604051808303818680612f77617c0c565b158015612f8357600080fd5b505a612f8d617c56565b5050505050158015612fa3573d6000803e3d6000fd5b505050506040513d6020811015612fb957600080fd5b50516000828152600c60205260409020600181612fd4617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790613010617cea565b505060019092019150612e8c9050565b5050565b60006001610e79617bbb565b600073ffffffffffffffffffffffffffffffffffffffff82166001600b613055617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161461309557506000610f61565b60005b600d806130a3617bbb565b9050811015613249576000600d82816130ba617bbb565b81106130c257fe5b906000526020600020016130d4617bbb565b6000818152600c60205260408120919250906130ee617bbb565b73ffffffffffffffffffffffffffffffffffffffff6101009290920a9004166001600b613119617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166321f8a721836040518263ffffffff1660e01b8152600401808281526020019150506020604051808303818680613181617c0c565b15801561318d57600080fd5b505a613197617c56565b50505050501580156131ad573d6000803e3d6000fd5b505050506040513d60208110156131c357600080fd5b505173ffffffffffffffffffffffffffffffffffffffff1614158061323057506000818152600c6020526040812081906131fb617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16145b1561324057600092505050610f61565b50600101613098565b50600192915050565b600061325c6169a7565b73ffffffffffffffffffffffffffffffffffffffff1663db2b91cf8360006007613284617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166370a08231866040518263ffffffff1660e01b8152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019150506020604051808303818680613318617c0c565b15801561332457600080fd5b505a61332e617c56565b5050505050158015613344573d6000803e3d6000fd5b505050506040513d602081101561335a57600080fd5b5051604080517fffffffff0000000000000000000000000000000000000000000000000000000060e086901b16815273ffffffffffffffffffffffffffffffffffffffff909316600484015260248301919091528051604480840193829003018186806133c5617c0c565b1580156133d157600080fd5b505a6133db617c56565b50505050501580156133f1573d6000803e3d6000fd5b505050506040513d604081101561340757600080fd5b505192915050565b613417616d8c565b73ffffffffffffffffffffffffffffffffffffffff165a613436617cc6565b73ffffffffffffffffffffffffffffffffffffffff16146134b857604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601e60248201527f4f6e6c792045786368616e6765722063616e20696e766f6b6520746869730000604482015290519081900360640190fd5b600060046134c4617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663907dff978686868686604051602001808681526020018581526020018481526020018381526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019550505050505060405160208183030381529060405260026040518080617e4b603e9139603e019050604051809103902061358c8b617322565b6000806040518763ffffffff1660e01b815260040180806020018781526020018681526020018581526020018460001b81526020018360001b8152602001828103825288818151815260200191508051906020019080838360005b838110156135ff5781810151838201526020016135e7565b50505050905090810190601f16801561362c5780820380516001836020036101000a031916815260200191505b509750505050505050506000604051808303816000878061364b617c0c565b15801561365757600080fd5b505a613661617d3a565b505050505050158015613678573d6000803e3d6000fd5b50505050505050505050565b61368c616d8c565b73ffffffffffffffffffffffffffffffffffffffff165a6136ab617cc6565b73ffffffffffffffffffffffffffffffffffffffff161461372d57604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601e60248201527f4f6e6c792045786368616e6765722063616e20696e766f6b6520746869730000604482015290519081900360640190fd5b60006004613739617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663907dff978383604051602001808381526020018281526020019250505060405160208183030381529060405260026040518080617f2260279139602701905060405180910390206137bd88617322565b6000806040518763ffffffff1660e01b815260040180806020018781526020018681526020018581526020018460001b81526020018360001b8152602001828103825288818151815260200191508051906020019080838360005b83811015613830578181015183820152602001613818565b50505050905090810190601f16801561385d5780820380516001836020036101000a031916815260200191505b509750505050505050506000604051808303816000878061387c617c0c565b15801561388857600080fd5b505a613892617d3a565b5050505050501580156138a9573d6000803e3d6000fd5b50505050505050565b60008060076138bf617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166370a08231836040518263ffffffff1660e01b8152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019150506020604051808303818680610f1a617c0c565b606061395d6169a7565b73ffffffffffffffffffffffffffffffffffffffff166372cb051f6040518163ffffffff1660e01b8152600401600060405180830381868061399d617c0c565b1580156139a957600080fd5b505a6139b3617c56565b50505050501580156139c9573d6000803e3d6000fd5b505050506040513d6000823e601f3d9081017fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe01682016040526020811015613a1057600080fd5b8101908080516040519392919084640100000000821115613a3057600080fd5b908301906020820185811115613a4557600080fd5b8251866020820283011164010000000082111715613a6257600080fd5b82525081516020918201928201910280838360005b83811015613a8f578181015183820152602001613a77565b50505050905001604052505050905090565b60006001613aad617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a613ae9617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614613b55576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401808060200182810382526035815260200180617dee6035913960400191505060405180910390fd5b7fb532073b38c83145e3e5135377a08bf9aab55bc0fd7c1179cd4fb995d2a5159c600080613b81617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff166001600090613bab617bbb565b6040805173ffffffffffffffffffffffffffffffffffffffff94851681526101009390930a909104909216602082015281519081900390910190a160006001613bf2617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff166000806101000a81613c1f617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790613c5b617cea565b5050506000600160006101000a81613c71617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790613cad617cea565b505050565b6000613cbc6169a7565b73ffffffffffffffffffffffffffffffffffffffff1663835e119c836040518263ffffffff1660e01b8152600401808281526020019150506020604051808303818680610f1a617c0c565b6000613d116169a7565b73ffffffffffffffffffffffffffffffffffffffff16637b1001b78360006040518363ffffffff1660e01b81526004018083815260200182151515158152602001925050506020604051808303818680610f1a617c0c565b613d71616b0c565b73ffffffffffffffffffffffffffffffffffffffff16637c3125416040518163ffffffff1660e01b81526004016000604051808303818680613db1617c0c565b158015613dbd57600080fd5b505a613dc7617c56565b5050505050158015613ddd573d6000803e3d6000fd5b505050506004600090613dee617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a613e2a617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614158015613eaa575060006005613e55617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a613e91617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614155b8015613f1257505a613eba617cc6565b73ffffffffffffffffffffffffffffffffffffffff1660006006613edc617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614155b15613f6d575a613f20617cc6565b6006600181613f2d617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790613f69617cea565b5050505b613f756169a7565b73ffffffffffffffffffffffffffffffffffffffff1663042e0688600060066125f6617bbb565b600080610e79617bbb565b7f735553440000000000000000000000000000000000000000000000000000000081565b600980613fd6617bbb565b600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280614011617bbb565b600181600116156101000203166002900480156110185780601f1061403d576101008083610fd8617bbb565b820191906000526020600020905b81614054617bbb565b8152906001019060200180831161404b5750859350505050565b600080614079617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a6140b5617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614614121576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602f815260200180617eaf602f913960400191505060405180910390fd5b80600460018161412f617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179061416b617cea565b50506040805173ffffffffffffffffffffffffffffffffffffffff8416815290517ffc80377ca9c49cc11ae6982f390a42db976d5530af7c43889264b13fbbd7c57e92509081900360200190a150565b6141c3616b0c565b73ffffffffffffffffffffffffffffffffffffffff16637c3125416040518163ffffffff1660e01b81526004016000604051808303818680614203617c0c565b15801561420f57600080fd5b505a614219617c56565b505050505015801561422f573d6000803e3d6000fd5b505050506004600090614240617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a61427c617cc6565b73ffffffffffffffffffffffffffffffffffffffff16141580156142fc5750600060056142a7617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a6142e3617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614155b801561436457505a61430c617cc6565b73ffffffffffffffffffffffffffffffffffffffff166000600661432e617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614155b156143bf575a614372617cc6565b600660018161437f617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217906143bb617cea565b5050505b6143c76169a7565b73ffffffffffffffffffffffffffffffffffffffff1663497d704a600060066143ee617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff166040518263ffffffff1660e01b8152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060006040518083038160008780614468617c0c565b15801561447457600080fd5b505a61447e617d3a565b505050505050158015611c88573d6000803e3d6000fd5b600080808060046144a4617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a6144e0617cc6565b73ffffffffffffffffffffffffffffffffffffffff161415801561456057506000600561450b617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a614547617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614155b80156145c857505a614570617cc6565b73ffffffffffffffffffffffffffffffffffffffff1660006006614592617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614155b15614623575a6145d6617cc6565b60066001816145e3617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179061461f617cea565b5050505b61462b616d8c565b73ffffffffffffffffffffffffffffffffffffffff16631b16802c60006006614652617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff16866040518363ffffffff1660e01b8152600401808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200182815260200192505050606060405180830381600087806146d4617c0c565b1580156146e057600080fd5b505a6146ea617d3a565b50505050505015801561135e573d6000803e3d6000fd5b60008061470c617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a614748617cc6565b73ffffffffffffffffffffffffffffffffffffffff16146147b4576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602f815260200180617eaf602f913960400191505060405180910390fd5b600060036147c0617bbb565b906101000a900460ff1661483557604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601f60248201527f53656c66204465737472756374206e6f742079657420696e6974696174656400604482015290519081900360640190fd5b5a61483e617daa565b6224ea00600261484c617bbb565b01106148b957604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601b60248201527f53656c662064657374727563742064656c6179206e6f74206d65740000000000604482015290519081900360640190fd5b7f8a09e1677ced846cb537dc2b172043bd05a1a81ad7e0033a7ef8ba762df990b7600160036148e6617bbb565b604080516101009390930a90910473ffffffffffffffffffffffffffffffffffffffff168252516020918190039190910190a160016003614925617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16ff5b60006005610e79617bbb565b60006004614972617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a6149ae617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614158015614a2e5750600060056149d9617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a614a15617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614155b8015614a9657505a614a3e617cc6565b73ffffffffffffffffffffffffffffffffffffffff1660006006614a60617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614155b15614af1575a614aa4617cc6565b6006600181614ab1617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790614aed617cea565b5050505b600080614afc617bbb565b73ffffffffffffffffffffffffffffffffffffffff6101009290920a90041660006006614b27617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614614bc657604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601360248201527f4f776e6572206f6e6c792066756e6374696f6e00000000000000000000000000604482015290519081900360640190fd5b806007600181614bd4617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790614c10617cea565b5050506126aa8161733b565b6000614c266169a7565b73ffffffffffffffffffffffffffffffffffffffff1663a311c7c2836040518263ffffffff1660e01b8152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019150506020604051808303818680610f1a617c0c565b6224ea0081565b6000614cae6169a7565b73ffffffffffffffffffffffffffffffffffffffff1663a5fdc5de836040518263ffffffff1660e01b8152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019150506020604051808303818680610f1a617c0c565b6000806004614d32617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a614d6e617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614158015614dee575060006005614d99617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a614dd5617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614155b8015614e5657505a614dfe617cc6565b73ffffffffffffffffffffffffffffffffffffffff1660006006614e20617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614155b15614eb1575a614e64617cc6565b6006600181614e71617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790614ead617cea565b5050505b614eb9616b0c565b73ffffffffffffffffffffffffffffffffffffffff1663086dabd16040518163ffffffff1660e01b81526004016000604051808303818680614ef9617c0c565b158015614f0557600080fd5b505a614f0f617c56565b5050505050158015614f25573d6000803e3d6000fd5b50505050614f5c6006600090614f39617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1683616ded565b506112a460006006614f6c617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff168484617498565b614f98617dce565b60005b600d80614fa6617bbb565b9050811015614fee57600d8181614fbb617bbb565b8110614fc357fe5b90600052602060002001614fd5617bbb565b828260188110614fe157fe5b6020020152600101614f9b565b5090565b614ffa616d8c565b73ffffffffffffffffffffffffffffffffffffffff165a615019617cc6565b73ffffffffffffffffffffffffffffffffffffffff161461509b57604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601e60248201527f4f6e6c792045786368616e6765722063616e20696e766f6b6520746869730000604482015290519081900360640190fd5b600060046150a7617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663907dff978383604051602001808381526020018281526020019250505060405160208183030381529060405260026040518080617e2360289139602801905060405180910390206137bd88617322565b615133616b0c565b73ffffffffffffffffffffffffffffffffffffffff16637c3125416040518163ffffffff1660e01b81526004016000604051808303818680615173617c0c565b15801561517f57600080fd5b505a615189617c56565b505050505015801561519f573d6000803e3d6000fd5b5050505060046000906151b0617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a6151ec617cc6565b73ffffffffffffffffffffffffffffffffffffffff161415801561526c575060006005615217617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a615253617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614155b80156152d457505a61527c617cc6565b73ffffffffffffffffffffffffffffffffffffffff166000600661529e617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614155b1561532f575a6152e2617cc6565b60066001816152ef617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179061532b617cea565b5050505b6153376169a7565b73ffffffffffffffffffffffffffffffffffffffff1663c8977132600060066143ee617bbb565b600060036129d8617bbb565b60006004615376617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a6153b2617cc6565b73ffffffffffffffffffffffffffffffffffffffff16148061542f5750600060056153db617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a615417617cc6565b73ffffffffffffffffffffffffffffffffffffffff16145b61549a57604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601760248201527f4f6e6c79207468652070726f78792063616e2063616c6c000000000000000000604482015290519081900360640190fd5b806006600181611c4c617bbb565b6000806154b3617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a6154ef617cc6565b73ffffffffffffffffffffffffffffffffffffffff161461555b576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602f815260200180617eaf602f913960400191505060405180910390fd5b5a615564617daa565b80600261556f617cea565b5050506001600360006101000a81615585617bbb565b8160ff0219169083151502179061559a617cea565b5050604080516224ea00815290517fcbd94ca75b8dc45c9d80c77e851670e78843c0d75180cb81db3e2158228fa9a692509081900360200190a1565b6155de616b0c565b73ffffffffffffffffffffffffffffffffffffffff16637c3125416040518163ffffffff1660e01b8152600401600060405180830381868061561e617c0c565b15801561562a57600080fd5b505a615634617c56565b505050505015801561564a573d6000803e3d6000fd5b50505050600460009061565b617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a615697617cc6565b73ffffffffffffffffffffffffffffffffffffffff16141580156157175750600060056156c2617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a6156fe617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614155b801561577f57505a615727617cc6565b73ffffffffffffffffffffffffffffffffffffffff1660006006615749617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614155b156157da575a61578d617cc6565b600660018161579a617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217906157d6617cea565b5050505b6157e26169a7565b73ffffffffffffffffffffffffffffffffffffffff16639a5154b4836000600661580a617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff16846040518463ffffffff1660e01b8152600401808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018281526020019350505050600060405180830381600087806158bf617c0c565b1580156158cb57600080fd5b505a6158d5617d3a565b5050505050501580156158ec573d6000803e3d6000fd5b505050505050565b60016003610e79617bbb565b600d818161590c617bbb565b811061591457fe5b60009182526020909120019050611e65617bbb565b60008382615935616b0c565b73ffffffffffffffffffffffffffffffffffffffff16637118d4316040518163ffffffff1660e01b81526004016000604051808303818680615975617c0c565b15801561598157600080fd5b505a61598b617c56565b50505050501580156159a1573d6000803e3d6000fd5b505050506159ad616b0c565b73ffffffffffffffffffffffffffffffffffffffff16636132eba483836040518363ffffffff1660e01b815260040180838152602001828152602001925050506000604051808303818680615a00617c0c565b158015615a0c57600080fd5b505a615a16617c56565b5050505050158015615a2c573d6000803e3d6000fd5b505050506004600090615a3d617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a615a79617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614158015615af9575060006005615aa4617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a615ae0617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614155b8015615b6157505a615b09617cc6565b73ffffffffffffffffffffffffffffffffffffffff1660006006615b2b617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614155b15615bbc575a615b6f617cc6565b6006600181615b7c617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790615bb8617cea565b5050505b615bc4616d8c565b73ffffffffffffffffffffffffffffffffffffffff16636a1c47588860006006615bec617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff168989896040518663ffffffff1660e01b8152600401808673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018481526020018381526020018281526020019550505050505060206040518083038160008780615cb1617c0c565b158015615cbd57600080fd5b505a615cc7617d3a565b505050505050158015615cde573d6000803e3d6000fd5b505050506040513d6020811015615cf457600080fd5b5051979650505050505050565b6000615d0b6169a7565b73ffffffffffffffffffffffffffffffffffffffff1663d37c4d8b84846040518363ffffffff1660e01b8152600401808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001828152602001925050506020604051808303818680615d8a617c0c565b158015615d9657600080fd5b505a615da0617c56565b5050505050158015615db6573d6000803e3d6000fd5b505050506040513d6020811015615dcc57600080fd5b50519392505050565b6000615ddf6169a7565b73ffffffffffffffffffffffffffffffffffffffff16637b1001b78360016040518363ffffffff1660e01b81526004018083815260200182151515158152602001925050506020604051808303818680610f1a617c0c565b60006006610e79617bbb565b6000615e4d6169a7565b73ffffffffffffffffffffffffffffffffffffffff1663dbf633406040518163ffffffff1660e01b81526004016020604051808303818680615e8d617c0c565b158015615e9957600080fd5b505a615ea3617c56565b5050505050158015615eb9573d6000803e3d6000fd5b505050506040513d6020811015615ecf57600080fd5b5051905090565b6000806007615ee3617bbb565b604080517fdd62ed3e00000000000000000000000000000000000000000000000000000000815273ffffffffffffffffffffffffffffffffffffffff8781166004830152868116602483015291516101009490940a909204169163dd62ed3e9160448082019260209290919082900301818680615d8a617c0c565b601881565b6000615f6d616b0c565b73ffffffffffffffffffffffffffffffffffffffff1663086dabd16040518163ffffffff1660e01b81526004016000604051808303818680615fad617c0c565b158015615fb957600080fd5b505a615fc3617c56565b5050505050158015615fd9573d6000803e3d6000fd5b505050506004600090615fea617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a616026617cc6565b73ffffffffffffffffffffffffffffffffffffffff16141580156160a6575060006005616051617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a61608d617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614155b801561610e57505a6160b6617cc6565b73ffffffffffffffffffffffffffffffffffffffff16600060066160d8617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614155b15616169575a61611c617cc6565b6006600181616129617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790616165617cea565b5050505b6000806161746169a7565b73ffffffffffffffffffffffffffffffffffffffff1663a63c4df486866000600661619d617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff166040518463ffffffff1660e01b8152600401808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018381526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019350505050604080518083038160008780616250617c0c565b15801561625c57600080fd5b505a616266617d3a565b50505050505015801561627d573d6000803e3d6000fd5b505050506040513d604081101561629357600080fd5b50805160209091015190925090506162d5858383600060066162b3617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff166174a5565b61630885600060066162e5617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1684617498565b95945050505050565b616319616b0c565b73ffffffffffffffffffffffffffffffffffffffff16637c3125416040518163ffffffff1660e01b81526004016000604051808303818680616359617c0c565b15801561636557600080fd5b505a61636f617c56565b5050505050158015616385573d6000803e3d6000fd5b505050506004600090616396617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a6163d2617cc6565b73ffffffffffffffffffffffffffffffffffffffff16141580156164525750600060056163fd617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a616439617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614155b80156164ba57505a616462617cc6565b73ffffffffffffffffffffffffffffffffffffffff1660006006616484617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614155b15616515575a6164c8617cc6565b60066001816164d5617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790616511617cea565b5050505b61651d6169a7565b73ffffffffffffffffffffffffffffffffffffffff166344ec6b62836000600661580a617bbb565b60006007610e79617bbb565b60006004610e79617bbb565b60008382616569616b0c565b73ffffffffffffffffffffffffffffffffffffffff16637118d4316040518163ffffffff1660e01b815260040160006040518083038186806165a9617c0c565b1580156165b557600080fd5b505a6165bf617c56565b50505050501580156165d5573d6000803e3d6000fd5b505050506165e1616b0c565b73ffffffffffffffffffffffffffffffffffffffff16636132eba483836040518363ffffffff1660e01b815260040180838152602001828152602001925050506000604051808303818680616634617c0c565b15801561664057600080fd5b505a61664a617c56565b5050505050158015616660573d6000803e3d6000fd5b505050506004600090616671617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a6166ad617cc6565b73ffffffffffffffffffffffffffffffffffffffff161415801561672d5750600060056166d8617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff165a616714617cc6565b73ffffffffffffffffffffffffffffffffffffffff1614155b801561679557505a61673d617cc6565b73ffffffffffffffffffffffffffffffffffffffff166000600661675f617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614155b156167f0575a6167a3617cc6565b60066001816167b0617bbb565b8173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217906167ec617cea565b5050505b6167f8616d8c565b73ffffffffffffffffffffffffffffffffffffffff16630a1e187d6000600661681f617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff16888888600660009061684c617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff166040518663ffffffff1660e01b8152600401808673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018581526020018481526020018381526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001955050505050506020604051808303816000878061690e617c0c565b15801561691a57600080fd5b505a616924617d3a565b50505050505015801561693b573d6000803e3d6000fd5b505050506040513d602081101561695157600080fd5b50519695505050505050565b60006169676169a7565b73ffffffffffffffffffffffffffffffffffffffff1663f354cad16040518163ffffffff1660e01b81526004016020604051808303818680615e8d617c0c565b6000616a087f49737375657200000000000000000000000000000000000000000000000000006040518060400160405280601681526020017f4d697373696e672049737375657220616464726573730000000000000000000081525061765f565b905090565b60006004616a19617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663907dff97826040516020018082815260200191505060405160208183030381529060405260036040518080617ede6021913960210190506040518091039020616a9588617322565b616a9e88617322565b60006040518763ffffffff1660e01b815260040180806020018781526020018681526020018581526020018481526020018360001b81526020018281038252888181518152602001915080519060200190808383600083811015613830578181015183820152602001613818565b6000616a087f53797374656d53746174757300000000000000000000000000000000000000006040518060400160405280601c81526020017f4d697373696e672053797374656d53746174757320616464726573730000000081525061765f565b6000616a087f52657761726473446973747269627574696f6e00000000000000000000000000604051806060016040528060238152602001617eff6023913961765f565b6000616a087f537570706c795363686564756c650000000000000000000000000000000000006040518060400160405280601e81526020017f4d697373696e6720537570706c795363686564756c652061646472657373000081525061765f565b600082821115616c8357604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601e60248201527f536166654d6174683a207375627472616374696f6e206f766572666c6f770000604482015290519081900360640190fd5b50900390565b600082820183811015616cfd57604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601b60248201527f536166654d6174683a206164646974696f6e206f766572666c6f770000000000604482015290519081900360640190fd5b9392505050565b60006004616d10617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663907dff97826040516020018082815260200191505060405160208183030381529060405260036040518080617f7b6021913960210190506040518091039020616a9588617322565b6000616a087f45786368616e67657200000000000000000000000000000000000000000000006040518060400160405280601981526020017f4d697373696e672045786368616e67657220616464726573730000000000000081525061765f565b600080616df8617746565b604080517f8b3f808800000000000000000000000000000000000000000000000000000000815273ffffffffffffffffffffffffffffffffffffffff87811660048301528251931692638b3f80889260248084019391929182900301818680616e5f617c0c565b158015616e6b57600080fd5b505a616e75617c56565b5050505050158015616e8b573d6000803e3d6000fd5b505050506040513d6040811015616ea157600080fd5b5051905080156112a457600080616eb66169a7565b73ffffffffffffffffffffffffffffffffffffffff1663db2b91cf8760006007616ede617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166370a082318a6040518263ffffffff1660e01b8152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019150506020604051808303818680616f72617c0c565b158015616f7e57600080fd5b505a616f88617c56565b5050505050158015616f9e573d6000803e3d6000fd5b505050506040513d6020811015616fb457600080fd5b5051604080517fffffffff0000000000000000000000000000000000000000000000000000000060e086901b16815273ffffffffffffffffffffffffffffffffffffffff9093166004840152602483019190915280516044808401938290030181868061701f617c0c565b15801561702b57600080fd5b505a617035617c56565b505050505015801561704b573d6000803e3d6000fd5b505050506040513d604081101561706157600080fd5b5080516020909101519092509050818511156170c8576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401808060200182810382526026815260200180617e896026913960400191505060405180910390fd5b801561713557604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601c60248201527f412073796e7468206f7220534e582072617465206973207374616c6500000000604482015290519081900360640190fd5b50600195945050505050565b600080600761714e617bbb565b73ffffffffffffffffffffffffffffffffffffffff6101009290920a90041663da46098c858761724f8660006007617184617bbb565b604080517fdd62ed3e00000000000000000000000000000000000000000000000000000000815273ffffffffffffffffffffffffffffffffffffffff8e811660048301528f8116602483015291516101009490940a909204169163dd62ed3e91604480820192602092909190829003018186806171ff617c0c565b15801561720b57600080fd5b505a617215617c56565b505050505015801561722b573d6000803e3d6000fd5b505050506040513d602081101561724157600080fd5b50519063ffffffff616c1216565b6040518463ffffffff1660e01b8152600401808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018281526020019350505050600060405180830381600087806172e6617c0c565b1580156172f257600080fd5b505a6172fc617d3a565b505050505050158015617313573d6000803e3d6000fd5b505050506163088484846177a7565b73ffffffffffffffffffffffffffffffffffffffff1690565b60006004617347617bbb565b6040805173ffffffffffffffffffffffffffffffffffffffff8581166020808401919091528351808403820181528385018086527f546f6b656e5374617465557064617465642861646472657373290000000000009052935192839003605a0183207f907dff97000000000000000000000000000000000000000000000000000000008452600160248501819052604485018290526000606486018190526084860181905260a4860181905260c060048701908152875160c488015287516101009a909a0a909804949094169763907dff979791959294938493849392839260e4909201918a0190808383885b8381101561744c578181015183820152602001617434565b50505050905090810190601f1680156174795780820380516001836020036101000a031916815260200191505b5097505050505050505060006040518083038160008780612678617c0c565b60006123bb8484846177a7565b600060046174b1617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663907dff97848484604051602001808481526020018381526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001935050505060405160208183030381529060405260026040518080617f49603291396032019050604051809103902061756989617322565b6000806040518763ffffffff1660e01b815260040180806020018781526020018681526020018581526020018460001b81526020018360001b8152602001828103825288818151815260200191508051906020019080838360005b838110156175dc5781810151838201526020016175c4565b50505050905090810190601f1680156176095780820380516001836020036101000a031916815260200191505b5097505050505050505060006040518083038160008780617628617c0c565b15801561763457600080fd5b505a61763e617d3a565b505050505050158015617655573d6000803e3d6000fd5b5050505050505050565b6000828152600c6020526040812081908190617679617bbb565b73ffffffffffffffffffffffffffffffffffffffff6101009290920a9004169050828161773e576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825283818151815260200191508051906020019080838360005b838110156177035781810151838201526020016176eb565b50505050905090810190601f1680156177305780820380516001836020036101000a031916815260200191505b509250505060405180910390fd5b509392505050565b6000616a087f53796e74686574697853746174650000000000000000000000000000000000006040518060400160405280601e81526020017f4d697373696e672053796e74686574697853746174652061646472657373000081525061765f565b600073ffffffffffffffffffffffffffffffffffffffff83161580159061781057505a63996d79a5620800008160e01b81526020816004836000335af1806177ee57600080fd5b505173ffffffffffffffffffffffffffffffffffffffff868116911614159150505b8015617870575060006004617823617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff1614155b6178db57604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601f60248201527f43616e6e6f74207472616e7366657220746f2074686973206164647265737300604482015290519081900360640190fd5b600060076178e7617bbb565b73ffffffffffffffffffffffffffffffffffffffff6101009290920a90041663b46310f6856179b0856000600761791c617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166370a082318a6040518263ffffffff1660e01b8152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060206040518083038186806171ff617c0c565b6040518363ffffffff1660e01b8152600401808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018281526020019250505060006040518083038160008780617a14617c0c565b158015617a2057600080fd5b505a617a2a617d3a565b505050505050158015617a41573d6000803e3d6000fd5b505050506007600090617a52617bbb565b73ffffffffffffffffffffffffffffffffffffffff6101009290920a90041663b46310f684617b1b8560006007617a87617bbb565b906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166370a08231896040518263ffffffff1660e01b8152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060206040518083038186806117df617c0c565b6040518363ffffffff1660e01b8152600401808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018281526020019250505060006040518083038160008780617b7f617c0c565b158015617b8b57600080fd5b505a617b95617d3a565b505050505050158015617bac573d6000803e3d6000fd5b505050506112a4848484616d04565b7f209662080000000000000000000000000000000000000000000000000000000062080000908152620800048390526320966208906020816024816000335af180617c0557600080fd5b5051925050565b7fc3382d0f00000000000000000000000000000000000000000000000000000000620800009081526208000483905263c3382d0f906020816024816000335af180617c0557600080fd5b7ffbb0f79d00000000000000000000000000000000000000000000000000000000620800009081526208000484905263fbb0f79d9060005b87811015617ca9578681015182820160240152602001617c8e565b50888888602401836000335af180617cc057600080fd5b98505050565b6373509064620800008160e01b81526020816004836000335af180617c0557600080fd5b7f28dcb2a0000000000000000000000000000000000000000000000000000000006208000090815262080004839052620800248490526328dcb2a09060008160448183335af180613cad57600080fd5b7f4c6d7c84000000000000000000000000000000000000000000000000000000006208000090815262080004849052634c6d7c849060005b88811015617d8d578781015182820160240152602001617d72565b50898989602401836000335af180617da457600080fd5b99505050565b63bdbf8c36620800008160e01b81526020816004836000335af180617c0557600080fd5b604051806103000160405280601890602082028038833950919291505056fe596f75206d757374206265206e6f6d696e61746564206265666f726520796f752063616e20616363657074206f776e65727368697045786368616e67655265636c61696d28616464726573732c627974657333322c75696e743235362953796e746845786368616e676528616464726573732c627974657333322c75696e743235362c627974657333322c75696e743235362c616464726573732943616e6e6f74207472616e73666572207374616b6564206f7220657363726f77656420534e584f6e6c792074686520636f6e7472616374206f776e6572206d617920706572666f726d207468697320616374696f6e417070726f76616c28616464726573732c616464726573732c75696e74323536294d697373696e672052657761726473446973747269627574696f6e206164647265737345786368616e676552656261746528616464726573732c627974657333322c75696e74323536294163636f756e744c69717569646174656428616464726573732c75696e743235362c75696e743235362c61646472657373295472616e7366657228616464726573732c616464726573732c75696e7432353629a265627a7a72315820c928209c56849c6a20bd37206a12ebc76794bf68ede11216041255d5c8d5786c64736f6c637828302e352e31362d646576656c6f702e323032302e372e32392b636f6d6d69742e36326536346536370058'
    it.only('Gas cost for synthetix deployed bytecode safety check', async () => {
      const data = await safetyChecker.interface.encodeFunctionData(
        'isBytecodeSafe',
        ['0x' + synthetixDeployedBytecode]
      )
      const tx = {
        to: safetyChecker.address,
        data
      }

      const res = await safetyChecker.provider.estimateGas(tx)
      console.log(`estimate gas result for synthetix initcode x2: ${res}`)

      const isSAfe: boolean = await safetyChecker.isBytecodeSafe(synthetixInitcode)
      console.log(`and is it safe? ${isSAfe}`)
    })
    describe('Empty case', () => {
      it('should work for empty case', async () => {
        const res: boolean = await safetyChecker.isBytecodeSafe([])
        res.should.eq(true, `empty bytecode should be whitelisted!`)
      })
    })

    describe('Single op-code cases', async () => {
      it('should correctly classify non-whitelisted', async () => {
        for (const opcode of DEFAULT_UNSAFE_OPCODES) {
          const res: boolean = await safetyChecker.isBytecodeSafe(
            `0x${opcode.code.toString('hex')}`
          )
          res.should.eq(
            false,
            `Opcode ${opcode.name} whitelisted by contract when it shouldn't be!`
          )
        }
      })

      it('should correctly classify whitelisted', async () => {
        for (const opcode of whitelistedNotHaltingOrCALL) {
          if (!opcode.name.startsWith('PUSH')) {
            const res: boolean = await safetyChecker.isBytecodeSafe(
              `0x${opcode.code.toString('hex')}`
            )
            res.should.eq(
              true,
              `Opcode ${opcode.name} not whitelisted by contract when it should be!`
            )
          }
        }
      })
    })

    describe('PUSH cases', async () => {
      it('skips at least specified number of bytes for PUSH cases', async () => {
        const invalidOpcode: string = DEFAULT_UNSAFE_OPCODES[0].code.toString(
          'hex'
        )
        const push1Code: number = parseInt(
          Opcode.PUSH1.code.toString('hex'),
          16
        )
        for (let i = 1; i < 33; i++) {
          const bytecode: string = `0x${Buffer.of(push1Code + i - 1).toString(
            'hex'
          )}${invalidOpcode.repeat(i)}`
          const res: boolean = await safetyChecker.isBytecodeSafe(bytecode)
          res.should.eq(
            true,
            `PUSH${i} failed by not skipping ${i} bytes of bytecode!`
          )
        }
      })

      it('skips at most specified number of bytes for PUSH cases', async () => {
        const invalidOpcode: string = DEFAULT_UNSAFE_OPCODES[0].code.toString(
          'hex'
        )
        const push1Code: number = parseInt(
          Opcode.PUSH1.code.toString('hex'),
          16
        )
        for (let i = 1; i < 33; i++) {
          const bytecode: string = `0x${Buffer.of(push1Code + i - 1).toString(
            'hex'
          )}${invalidOpcode.repeat(i + 1)}`
          const res: boolean = await safetyChecker.isBytecodeSafe(bytecode)
          res.should.eq(
            false,
            `PUSH${i} succeeded, skipping ${i +
              1} bytes of bytecode when it should have skipped ${i} bytes!`
          )
        }
      })
    })

    describe('multiple opcode cases', async () => {
      it('works for whitelisted, non-halting codes', async () => {
        let bytecode: string = '0x'
        const invalidOpcode: string = DEFAULT_UNSAFE_OPCODES[0].code.toString(
          'hex'
        )

        for (const opcode of whitelistedNotHaltingOrCALL) {
          bytecode += `${opcode.code.toString('hex')}${invalidOpcode.repeat(
            opcode.programBytesConsumed
          )}`
        }

        const res: boolean = await safetyChecker.isBytecodeSafe(bytecode)
        res.should.eq(true, `Bytecode of all whitelisted (non-halting) failed!`)
      })

      it('fails for non-halting whitelisted codes with one not on whitelist at the end', async () => {
        let bytecode: string = '0x'
        const invalidOpcode: string = DEFAULT_UNSAFE_OPCODES[0].code.toString(
          'hex'
        )

        for (const opcode of whitelistedNotHaltingOrCALL) {
          bytecode += `${opcode.code.toString('hex')}${invalidOpcode.repeat(
            opcode.programBytesConsumed
          )}`
        }
        for (const opcode of DEFAULT_UNSAFE_OPCODES) {
          const res: boolean = await safetyChecker.isBytecodeSafe(
            bytecode + opcode.code.toString('hex')
          )
          res.should.eq(
            false,
            `Bytecode of all whitelisted (non-halting) + ${opcode.name} passed when it should have failed!`
          )
        }
      }).timeout(30_000)
    })

    describe('handles unreachable code', async () => {
      it(`skips unreachable bytecode after a halting opcode`, async () => {
        for (const haltingOp of haltingOpcodes) {
          let bytecode: string = '0x'
          bytecode += haltingOp.code.toString('hex')
          for (const opcode of DEFAULT_UNSAFE_OPCODES) {
            bytecode += opcode.code.toString('hex')
          }
          const res: boolean = await safetyChecker.isBytecodeSafe(bytecode)
          res.should.eq(
            true,
            `Bytecode containing invalid opcodes in unreachable code after a ${haltingOp.name} failed!`
          )
        }
      })
      it('skips bytecode after an unreachable JUMPDEST', async () => {
        for (const haltingOp of haltingOpcodesNoJump) {
          let bytecode: string = '0x'
          bytecode += haltingOp.code.toString('hex')
          bytecode += Opcode.JUMPDEST.code.toString('hex')
          for (const opcode of DEFAULT_UNSAFE_OPCODES) {
            bytecode += opcode.code.toString('hex')
          }
          const res: boolean = await safetyChecker.isBytecodeSafe(bytecode)
          res.should.eq(
            true,
            `Bytecode containing invalid opcodes after unreachable JUMPDEST (after a ${haltingOp.name}) failed!`
          )
        }
      })

      it('parses opcodes after a reachable JUMPDEST', async () => {
        for (const haltingOp of haltingOpcodesNoJump) {
          for (const jump of jumps) {
            let bytecode: string = '0x'
            bytecode += jump.code.toString('hex')
            bytecode += Opcode.JUMPDEST.code.toString('hex') // JUMPDEST here so that the haltingOp is reachable
            bytecode += haltingOp.code.toString('hex')
            bytecode += Opcode.JUMPDEST.code.toString('hex')
            for (const opcode of DEFAULT_UNSAFE_OPCODES) {
              bytecode += opcode.code.toString('hex')
            }
            const res: boolean = await safetyChecker.isBytecodeSafe(bytecode)
            res.should.eq(
              false,
              `Bytecode containing invalid opcodes after a JUMPDEST preceded by a ${haltingOp.name} and reachable by ${jump.name} should have failed!`
            )
          }
        }
      })

      it('parses opcodes after first JUMP and JUMPDEST', async () => {
        let bytecode: string = '0x'
        bytecode += Opcode.JUMP.code.toString('hex')
        bytecode += Opcode.JUMPDEST.code.toString('hex')
        for (const opcode of DEFAULT_UNSAFE_OPCODES) {
          bytecode += opcode.code.toString('hex')
        }
        const res: boolean = await safetyChecker.isBytecodeSafe(bytecode)
        res.should.eq(
          false,
          `Bytecode containing invalid opcodes after reachble JUMPDEST should have failed!`
        )
      })

      it('parses opcodes after JUMPI', async () => {
        let bytecode: string = '0x'
        bytecode += Opcode.JUMPI.code.toString('hex')
        for (const opcode of DEFAULT_UNSAFE_OPCODES) {
          bytecode += opcode.code.toString('hex')
        }
        const res: boolean = await safetyChecker.isBytecodeSafe(bytecode)
        res.should.eq(
          false,
          `Bytecode containing invalid opcodes after JUMPI should have failed!`
        )
      })

      it('should correctly handle alternating reachable/uncreachable code ending in reachable, valid code', async () => {
        for (const haltingOp of haltingOpcodesNoJump) {
          for (const jump of jumps) {
            let bytecode: string = '0x'
            bytecode += jump.code.toString('hex')
            // JUMPDEST here so that the haltingOp is reachable
            bytecode += Opcode.JUMPDEST.code.toString('hex')
            for (let i = 0; i < 3; i++) {
              bytecode += haltingOp.code.toString('hex')
              // Unreachable, invalid code
              for (const opcode of DEFAULT_UNSAFE_OPCODES) {
                bytecode += opcode.code.toString('hex')
              }
              bytecode += Opcode.JUMPDEST.code.toString('hex')
              // Reachable, valid code
              for (const opcode of whitelistedNotHaltingOrCALL) {
                bytecode += opcode.code.toString('hex')
              }
            }
            const res: boolean = await safetyChecker.isBytecodeSafe(bytecode)
            res.should.eq(
              true,
              `Long bytecode containing alternating valid reachable and invalid unreachable code failed!`
            )
          }
        }
      }).timeout(30_000)

      it('should correctly handle alternating reachable/uncreachable code ending in reachable, invalid code', async () => {
        for (const haltingOp of haltingOpcodesNoJump) {
          for (const jump of jumps) {
            let bytecode: string = '0x'
            bytecode += jump.code.toString('hex')
            // JUMPDEST here so that the haltingOp is reachable
            bytecode += Opcode.JUMPDEST.code.toString('hex')
            for (let i = 0; i < 3; i++) {
              bytecode += haltingOp.code.toString('hex')
              // Unreachable, invalid code
              for (const opcode of DEFAULT_UNSAFE_OPCODES) {
                bytecode += opcode.code.toString('hex')
              }
              bytecode += Opcode.JUMPDEST.code.toString('hex')
              // Reachable, valid code
              for (const opcode of whitelistedNotHaltingOrCALL) {
                bytecode += opcode.code.toString('hex')
              }
            }
            bytecode += DEFAULT_UNSAFE_OPCODES[0].code.toString('hex')
            const res: boolean = await safetyChecker.isBytecodeSafe(bytecode)
            res.should.eq(
              false,
              `Long bytecode ending in reachable, invalid code should have failed!`
            )
          }
        }
      }).timeout(30_000)
    })
    describe('handles CALLs', async () => {
      it(`accepts valid call, PUSHing gas`, async () => {
        const invalidOpcode: string = DEFAULT_UNSAFE_OPCODES[0].code.toString(
          'hex'
        )
        const push1Code: number = parseInt(
          Opcode.PUSH1.code.toString('hex'),
          16
        )
        // test for PUSH1...PUSH32
        for (let i = 1; i <= 32; i++) {
          let bytecode: string = '0x'
          // set value
          bytecode += Opcode.PUSH1.code.toString('hex')
          bytecode += '00' //PUSH1 0x00
          // set address
          bytecode += Opcode.PUSH20.code.toString('hex')
          bytecode += remove0x(executionManagerAddress) //PUSH20 Execution Manager address
          // set gas
          bytecode += Buffer.of(push1Code + i - 1).toString('hex')
          bytecode += invalidOpcode.repeat(i)
          // CALL
          bytecode += Opcode.CALL.code.toString('hex')
          const res: boolean = await safetyChecker.isBytecodeSafe(bytecode)
          res.should.eq(
            true,
            `Bytecode containing valid CALL using PUSH${i} to set gas failed!`
          )
        }
      })
      it(`accepts valid call, DUPing gas`, async () => {
        const invalidOpcode: string = DEFAULT_UNSAFE_OPCODES[0].code.toString(
          'hex'
        )
        const dup1Code: number = parseInt(Opcode.DUP1.code.toString('hex'), 16)
        // test for DUP1...DUP16
        for (let i = 1; i <= 16; i++) {
          let bytecode: string = '0x'
          // set value
          bytecode += Opcode.PUSH1.code.toString('hex')
          bytecode += '00' //PUSH1 0x00
          // set address
          bytecode += Opcode.PUSH20.code.toString('hex')
          bytecode += remove0x(executionManagerAddress) //PUSH20 Execution Manager address
          // set gas
          bytecode += Buffer.of(dup1Code + i - 1).toString('hex')
          // CALL
          bytecode += Opcode.CALL.code.toString('hex')
          const res: boolean = await safetyChecker.isBytecodeSafe(bytecode)
          res.should.eq(
            true,
            `Bytecode containing valid CALL using DUP${i} to set gas failed!`
          )
        }
      })
      it(`rejects invalid CALLs using opcodes other than PUSH or DUP to set gas`, async () => {
        const invalidGasSetters: EVMOpcode[] = whitelistedNotHaltingOrCALL.filter(
          (x) => !x.name.startsWith('PUSH') && !x.name.startsWith('DUP')
        )
        log.debug(`Invalid Gas Setters ${invalidGasSetters.map((x) => x.name)}`)
        // test for whitelisted, non-halting opcodes (excluding PUSHes or DUPs)
        for (const opcode of invalidGasSetters) {
          let bytecode: string = '0x'
          // set value
          bytecode += Opcode.PUSH1.code.toString('hex')
          bytecode += '00' //PUSH1 0x00
          // set address
          bytecode += Opcode.PUSH20.code.toString('hex')
          bytecode += remove0x(executionManagerAddress) //PUSH20 Execution Manager address
          // set gas with invalid opcode
          bytecode += opcode.code.toString('hex')
          // CALL
          bytecode += Opcode.CALL.code.toString('hex')
          const res: boolean = await safetyChecker.isBytecodeSafe(bytecode)
          res.should.eq(
            false,
            `Bytecode containing invalid CALL using ${opcode.name} to set gas should have failed!`
          )
        }
      })
      it(`rejects invalid CALLs using opcodes other than PUSH1 to set value`, async () => {
        const invalidValueSetters: EVMOpcode[] = whitelistedNotHaltingOrCALL.filter(
          (x) => x.name !== 'PUSH1'
        )
        log.debug(
          `Invalid Value Setters ${invalidValueSetters.map((x) => x.name)}`
        )
        // test for whitelisted, non-halting opcodes (excluding PUSH1)
        for (const opcode of invalidValueSetters) {
          let bytecode: string = '0x'
          // set value with invalid opcode
          bytecode += opcode.code.toString('hex')
          if (opcode.programBytesConsumed > 0) {
            bytecode += '00'.repeat(opcode.programBytesConsumed) //PUSHX X_zero_bytes
          }
          // set address
          bytecode += Opcode.PUSH20.code.toString('hex')
          bytecode += remove0x(executionManagerAddress) //PUSH20 Execution Manager address
          // set gas
          bytecode += Opcode.PUSH32.code.toString('hex')
          bytecode += '11'.repeat(32) //PUSH32 0x11...11
          // CALL
          bytecode += Opcode.CALL.code.toString('hex')
          const res: boolean = await safetyChecker.isBytecodeSafe(bytecode)
          res.should.eq(
            false,
            `Bytecode containing invalid CALL using ${opcode.name} to set value should have failed!`
          )
        }
      }).timeout(20_000)
      it(`rejects invalid CALLs using opcodes other than PUSH20 to set address`, async () => {
        const invalidAddressSetters: EVMOpcode[] = whitelistedNotHaltingOrCALL.filter(
          (x) => x.name !== 'PUSH20'
        )
        log.debug(
          `Invalid Address Setters ${invalidAddressSetters.map((x) => x.name)}`
        )
        // test for whitelisted, non-halting opcodes (excluding PUSH20)
        for (const opcode of invalidAddressSetters) {
          let bytecode: string = '0x'
          // set value
          bytecode += Opcode.PUSH1.code.toString('hex')
          bytecode += '00' //PUSH1 0x00
          // set address with invalid opcode
          bytecode += opcode.code.toString('hex')
          if (opcode.programBytesConsumed > 0) {
            bytecode += '00'.repeat(opcode.programBytesConsumed) //PUSHX X_zero_bytes
          }
          // set gas
          bytecode += Opcode.PUSH32.code.toString('hex')
          bytecode += '11'.repeat(32) //PUSH32 0x11...11
          // CALL
          bytecode += Opcode.CALL.code.toString('hex')
          const res: boolean = await safetyChecker.isBytecodeSafe(bytecode)
          res.should.eq(
            false,
            `Bytecode containing invalid CALL using ${opcode.name} to set value should have failed!`
          )
        }
      }).timeout(20_000)
      it(`rejects invalid CALL with a non-zero value`, async () => {
        let bytecode: string = '0x'
        // set a non-zero value
        bytecode += Opcode.PUSH1.code.toString('hex')
        bytecode += '01' //PUSH1 0x01
        // set address
        bytecode += Opcode.PUSH20.code.toString('hex')
        bytecode += remove0x(executionManagerAddress) //PUSH20 Execution Manager address
        // set gas
        bytecode += Opcode.PUSH32.code.toString('hex')
        bytecode += '11'.repeat(32) //PUSH32 0x11...11
        // CALL
        bytecode += Opcode.CALL.code.toString('hex')
        const res: boolean = await safetyChecker.isBytecodeSafe(bytecode)
        res.should.eq(
          false,
          `Bytecode containing invalid CALL PUSH1ing non-zero value should have failed!`
        )
      })
      it(`rejects invalid CALL to a non-Execution Manager address`, async () => {
        let bytecode: string = '0x'
        // set value
        bytecode += Opcode.PUSH1.code.toString('hex')
        bytecode += '00' //PUSH1 0x00
        // set a non-Execution Manager address
        bytecode += Opcode.PUSH20.code.toString('hex')
        bytecode += 'ff'.repeat(20) //PUSH20 invalid address
        // set gas
        bytecode += Opcode.PUSH32.code.toString('hex')
        bytecode += '11'.repeat(32) //PUSH32 0x11...11
        // CALL
        bytecode += Opcode.CALL.code.toString('hex')
        const res: boolean = await safetyChecker.isBytecodeSafe(bytecode)
        res.should.eq(
          false,
          `Bytecode containing invalid CALL PUSH20ing non-Execution Manager address should have failed!`
        )
      })
      it(`rejects invalid CALL with only 2 preceding opcodes`, async () => {
        let bytecode: string = '0x'
        // set address
        bytecode += Opcode.PUSH20.code.toString('hex')
        bytecode += remove0x(executionManagerAddress) //PUSH20 Execution Manager address
        // set gas
        bytecode += Opcode.PUSH32.code.toString('hex')
        bytecode += '11'.repeat(32) //PUSH32 0x11...11
        // CALL
        bytecode += Opcode.CALL.code.toString('hex')
        const res: boolean = await safetyChecker.isBytecodeSafe(bytecode)
        res.should.eq(
          false,
          `Bytecode containing invalid CALL with only two preceding opcodes should have failed!`
        )
      })
    })
  })
})
